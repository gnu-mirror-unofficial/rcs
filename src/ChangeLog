2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move the config header (and template) from src/ to lib/.

	* base.h: Don't #include "auto-sussed.h";
	instead, #include "config.h".
	* Makefile.am (AM_CPPFLAGS): Delete var.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Remove now-obsolete support for !HAVE_SIGNAL_H.

	* base.h [!HAVE_SIGNAL_H] (catchints, ignoreints, restoreints):
	Delete macros, with surrounding cpp #if block.
	* rcsutil.c: Remove #if defined HAVE_SIGNAL_H, matching #endif.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <signal.h> to .c files.

	* base.h: Don't #include <signal.h>; remove surrounding
	cpp cond #ifdef HAVE_SIGNAL_H ... #endif block.
	* rcsutil.c: #include <signal.h>.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use GCC attributes individually.

	* b-complain.h (generic_fatal, fatl_syntax): Use attribute
	declarations `printf_string' and `exiting' directly.
	* base.h (printf_string_exiting): Delete macro.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <utime.h> to .c files.

	* base.h: Don't #include <utime.h>; remove surrounding
	cpp cond #ifdef HAVE_UTIME_H ... #endif block.
	* rcsedit.c [HAVE_UTIME_H]: #include <utime.h>.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <time.h> to .c files.

	* base.h: Don't #include <time.h>.
	* maketime.c: #include <time.h>.
	* partime.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume <unistd.h> provides STD{IN,OUT,ERR}_FILENO.

	* base.h (STDIN_FILENO, STDOUT_FILENO, STDERR_FILENO): Delete
	#define:s, and surrouding #ifndef STDIN_FILENO cpp cond block.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume <unistd.h> provides `getlogin' decl.

	* base.h (getlogin): Delete func decl.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <unistd.h> to .c files.

	* base.h: Don't #include <unistd.h>; remove surrounding
	cpp cond #ifdef HAVE_UNISTD_H ... #endif block.
	* ci.c: #include <unistd.h>.
	* rcsedit.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcslex.c: Likewise.
	* rcsutil.c: Likewise.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <string.h> to .c files.

	* base.h: Don't #include <string.h>.
	* b-anchor.c: #include <string.h>.
	* b-kwxout.c: Likewise.
	* ci.c: Likewise.
	* co.c: Likewise.
	* merger.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmerge.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume <errno.h> provides `ELOOP', `ENOTSUP'.

	* rcsedit.c (resolve_symlink) [!ELOOP]: Remove cpp cond block.
	* rcsutil.c (setup_catchsig): Assume `defined ENOTSUP' == 1.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <stdarg.h> to .c files.

	* base.h: Don't #include <stdarg.h>.
	* b-complain.c: #include <stdarg.h>.
	* rcsgen.c: Likewise.
	* rcslex.c: Likewise.
	* rcsutil.c: Likewise.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Incorporate `fvfprintf' into unique caller.

	* rcslex.c (fvfprintf): Incorporate into `aprintf'.
	* base.h (fvfprintf): Delete func decl.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <stdlib.h> to .c files.

	* base.h: Don't #include <stdlib.h>.
	* ci.c: #include <stdlib.h>.
	* co.c: Likewise.
	* ident.c: Likewise.
	* merger.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcslex.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-04-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Move #include <errno.h> to .c files.

	* base.h: Don't #include <errno.h>.
	* b-complain.c: #include <errno.h>.
	* ci.c: Likewise.
	* co.c: Likewise.
	* ident.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcslex.c: Likewise.
	* rcsutil.c: Likewise.

2010-04-02  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move GCC attribute configuration into base.h.

	* base.h (exiting, printf_string): Define these
	macros based solely on GCC version -- 2.7 or higher.
	(printf_string_exiting): Define macro unconditionally.

2010-04-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Use gnulib module `stdbool'.

	* Makefile.am (AM_CPPFLAGS): New var.

2010-04-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Use gnulib to define `RCS_UNUSED'.

	* base.h (RCS_UNUSED): Update.

2010-03-31  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Avoid some function-static vars.

	* rcsedit.c (setmtime): Make local var `amtime' non-static.
	* rcsfnms.c [!HAVE_MKSTEMP] (homegrown_mkstemp): Likewise for `xrep'.
	* rcsrev.c [REVTEST] (main): Likewise for `numricrevno'.
	Also, do `bufautobegin' and `bufautoend' for it.
	* rcslex.c (fd2_RILE): Delete static
	local var `nothing'; use `FROM (to)', instead.

2010-03-31  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "temporary buf for key value" to `struct manifestation'.

	* base.h (manifestation): Add member `keyval'.
	* b-kwxout.c (expandline): Use `MANI (keyval)'.

2010-03-31  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "`BE (interactive)' valid" into `struct behavior'.

	* base.h (behavior): Add member `interactive_valid'.
	* rcsgen.c (ttystdin): Use `BE (interactive_valid)'.

2010-03-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use `bool' more.

	* rcsutil.c (cacheid): Use boolean for valid bit.

2010-03-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "-z handling state" into `struct behavior'.

	* base.h (behavior): Add member `zone_offset'.
	* rcstime.c (zone_offset, use_zone_offset): Delete vars.
	(str2date, zone_set, date2str): Use
	`BE (zone_offset.valid)', `BE (zone_offset.seconds)'.

2010-03-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Use boolean to keep track of lexical error occurance.

	Here, "U" means "Throughout, use `LEX (erroneousp)'".
	* base.h (struct parse_state): Replace `nerr' with `erroneousp'.
	* b-complain.c (ERRONEOUS_X): New macro.
	(syserror, generic_error, generic_fatal): Use `ERRONEOUS_X'.
	* ci.c: U.
	* co.c: U.
	* merge.c: U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsedit.c: U.
	* rcskeep.c: U.
	* rcslex.c: U.
	* rcsmerge.c: U.
	* rlog.c: U.

2010-03-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Abstract writes to stderr.

	Here, "I" means "#include "b-complain.h",
	"U" means "Throughout, use the funcs and macros from there".
	* b-complain.c (vcomplain, complain): New funcs.
	(COMPLAIN_PLUS_NEWLINE): New macro.
	(diagnose): New func.
	(whoami): New static func.
	(syserror, generic_warn, generic_error): New funcs.
	(die): New static func.
	(generic_fatal, fatal_syntax, fatal_sys): New funcs.
	* b-complain.h (vcomplain, complain, diagnose, syserror)
	(generic_warn, generic_error, generic_fatal, fatal_syntax)
	(fatal_sys): New func decls.
	(syserror_errno, PWARN, MWARN, RWARN)
	(PERR, MERR, RERR, PFATAL, RFATAL): New macros.
	* b-kwxout.c: I; U.
	* ci.c: U.
	* co.c: U.
	* ident.c: U.
	* maketime.c: U.
	* merge.c: U.
	* merger.c: I; U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsedit.c: I; U.
	* rcsfcmp.c: I; U.
	* rcsfnms.c: I; U.
	* rcsgen.c: I; U.
	* rcskeep.c: I; U.
	* rcslex.c: I; U.
	(fatcleanup, startsay, fatsay, errsay, warnsay, eerror)
	(enerror, efaterror, enfaterror, error, rcserror)
	(workerror, fatserror, faterror, rcsfaterror, warn)
	(rcswarn, workwarn, diagnose): Delete funcs.
	* rcsmerge.c: U.
	* rcsrev.c: I; U.
	* rcssyn.c: I; U.
	* rcstime.c: I; U.
	* rcsutil.c: I; U.
	[HAVE_WORKING_FORK] (write_stderr): Delete func.
	(runv): If the child proc exited due to a signal,
	mention that it "got a fatal signal" before dying.
	* rlog.c: U.
	* base.h (efaterror, enfaterror, fatcleanup, faterror)
	(fatserror, rcsfaterror, diagnose, eerror, enerror, error)
	(rcserror, rcswarn, warn, workerror, workwarn): Delete func decls.

2010-03-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Unbuffer stderr at program start; don't fflush it, later.

	Here, "I" means "#include "b-complain.h"";
	and "U" means "(main) Use `unbuffer_standard_error'".
	* b-complain.h: New file.
	* b-complain.c: New file.
	* Makefile.am (libparts_a_SOURCES): Add b-complain.h, b-complain.c.
	* base.h (eflush): Delete func decl.
	* rcsgen.c (yesorno, getsstdin): Don't call `eflush'.
	* rcslex.c (eflush): Delete func.
	(enerror, error, rcserror, workerror, warn, rcswarn, workwarn)
	(diagnose): Don't call `eflush'.
	* rcsutil.c (runv): Likewise.
	* ci.c: I; U.
	* co.c: I; U.
	* ident.c: I; U.
	* merge.c: I; U.
	* rcs.c: I; U.
	(sendmail): Don't call `eflush'.
	* rcsclean.c: I; U.
	* rcsdiff.c: I; U.
	* rcsmerge.c: I; U.
	* rlog.c: I; U.

2010-03-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Drop workaround for SVR4 stdio bug.

	* rcsgen.c (putadmin): Don't bother using `putc'
	for first output operation; just use `printf' normally.
	* rlog.c (main): Likewise.

2010-03-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Tighten `homegrown_mkstemp'.

	* rcsfnms.c: #include <sys/time.h>.
	[!HAVE_MKSTEMP] (homegrown_mkstemp): Make static;
	use curly braces for string constant instead of parens.

2010-03-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "expansion + output" to b-kwxout.[hc]; use exp context.

	* b-kwxout.h: New file.
	* b-kwxout.c: New file.
	* Makefile.am (libparts_a_SOURCES): Add b-kwxout.h, b-kwxout.c.
	* base.h (expandline): Delete func decl.
	* ci.c: #include "b-kwxout.h".
	(xpandfile): Update call to `expandline'.
	* rcsedit.c: #include "b-kwxout.h".
	(finisheditline, finishedit, copylines)
	(xpandstring, editstring): Update call to `expandline'.

2010-03-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Use #define for `ciklog' et al.

	* base.h (ciklog): Convert from var decl to #define.
	(ciklog_len): New #define.
	(ciklogsize): Delete #define.
	* ci.c (getlogmsg): Use `ciklog_len'.
	* rcsedit.c (ciklog): Delete var.
	(keyreplace): Use `ciklog_len'.
	* rcsfcmp.c (rcsfcmp): Use `ciklog_len'.

2010-03-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Use #define for RCS file keywords.

	* base.h (KS): New macro.
	(Kaccess): Convert from var decl to #define; use `KS'.
	(Kauthor, Kbranch, Kcomment, Kdate, Kdesc, Kexpand, Khead, Klocks)
	(Klog, Knext, Kstate, Kstrict, Ksymbols, Ktext): Likewise.
	* rcssyn.c (Kaccess): Delete var.
	(Kauthor, Kbranch, Kcomment, Kdate, Kdesc, Kexpand, Khead, Klocks)
	(Klog, Knext, Kstate, Kstrict, Ksymbols, Ktext): Likewise.
	(Kbranches): Rename from `K_branches'; convert from var to #define.
	[COMPAT2] (Ksuffix): Convert from var to #define.
	(getdelta): Use `Kbranches'.

2010-03-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move some constant data from rcsutil.c to b-anchor.c.

	* b-anchor.c (prog_diff, prog_diff3, diff_flags, equal_line):
	New, moved without change from...
	* rcsutil.c (prog_diff, prog_diff3, diff_flags, equal_line):
	...here.

2010-03-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Overhaul "keyword-substitution mode name" recognition.

	* b-anchor.c (kwsub_pool): New static `uint8_t' array.
	(recognize_kwsub, kwsub_string): New funcs.
	* base.h (recognize_kwsub): New func decl.
	(str2expmode): New macro.
	(kwsub_string): New func decl.
	(str2expmode): Delete func decl.
	* rcsgen.c (putadmin): Use `kwsub_string'.
	* rcssyn.c (expand_names): Delete data structure.
	(strn2expmode, str2expmode): Delete funcs.
	(getadmin): Use `recognize_kwsub'.
	* rlog.c (main): Use `kwsub_string'.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Overhaul (working file) keyword recognition.

	* b-anchor.c: New file.
	* Makefile.am (libparts_a_SOURCES):
	Add b-anchor.c; remove rcskeys.c.
	* base.h: #include <stdint.h>.
	(AUTHOR, DATE, HEADER, IDH, LOCKER, LOG, NAME, RCSFILE, REVISION)
	(SOURCE, STATE): Delete #define:s.
	(tinysym, pool_found): New structs.
	(markers): From this enum, remove `Nomatch'.
	(recognize_keyword): New func decl.
	(Keyword): Delete var decl.
	(trymatch): Delete func decl.
	* rcsedit.c (keyreplace): Take `struct pool_found *'
	for first arg instead of `enum markers'; use `marker->i'.
	(expandline): Use `recognize_keyword'.
	* rcsfcmp.c (rcsfcmp): Use `recognize_keyword', `match1.i'.
	* rcskeep.c (getoldkeys): Use `recognize_keyword'.
	* rcskeys.c: Delete file.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Rename rcsbase.h to base.h.

	* base.h: Rename from rcsbase.h.
	* Makefile.am (libparts_a_SOURCES): Update.
	* ci.c: Update #include.
	* co.c: Likewise.
	* gnu-h-v.c: Likewise.
	* ident.c: Likewise.
	* maketime.c: Likewise.
	* merge.c: Likewise.
	* merger.c: Likewise.
	* partime.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcskeys.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmap.c: Likewise.
	* rcsmerge.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Remove spurious casts to void for function call.

	* rcs.c (main): Remove cast to void for `umask' call.
	* rcskeep.c (getoldkeys): Remove cast to void for `getval' call.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Dose data structures with `const'.

	* maketime.c (month_yday): Add `const' to var definition.
	* partime.c (month_names): Likewise.
	(weekday_names, zone_names, patterns): Likewise.
	* rcsfnms.c (rcsdir, comtable): Likewise.
	* rcssyn.c [COMPAT2] (Ksuffix): Likewise.
	(K_branches): Likewise.
	* rcsutil.c (regsigs, mmapsigs): Likewise.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Consolidate i/o streams into `struct flow'.

	Here, "U" means "Throughout, use `FLOW (foo)'
	instead of the old singular variable names".
	* rcsbase.h (flow): New struct.
	(flow): New `struct flow' decl.
	(FLOW): New macro.
	(fcopy, resultname, finptr, frewrite, foutptr): Delete var decls.
	* ci.c: U.
	* co.c: U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsedit.c: U.
	(fcopy, resultname): Delete var.
	* rcsfnms.c: U.
	* rcsgen.c: U.
	* rcslex.c: U.
	(finptr, frewrite, foutptr): Delete vars.
	* rcsrev.c: U.
	* rcssyn.c: U.
	* rcsutil.c (flow): New `struct flow'.
	* rlog.c: U.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "possible endings for RCS file" into `struct behavior'.

	Here, "U" means "Throughout, use `BE (pe)'".
	* rcsbase.h (suffixes): Delete var decl.
	(behavior): Add `pe' to this struct.
	* ci.c: U.
	* co.c: U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsfnms.c: U.
	(suffixes): Delete var.
	* rcsmerge.c: U.
	* rlog.c: U.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "temporary log buffer" into `struct manifestation'.

	Here, "U" means "Throughout, use `MANI (log)'".
	* rcsbase.h (curlogbuf): Delete var decl.
	(manifestation): Add `log' to this struct.
	* rcs.c: U.
	* rcsgen.c: U.
	(curlogbuf): Delete var.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Remove spurious `extern'.

	* rcsbase.h (isSLASH): Remove `extern' on func decl.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "keyword subtitution mode" into `struct behavior'.

	Here, "U" means "Throughout, use `BE (kws)'".
	* rcsbase.h (Expand): Delete var decl.
	(behavior): Add `kws' to this struct.
	* ci.c: U.
	* co.c: U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsedit.c: U.
	* rcsfcmp.c: U.
	* rcsfnms.c: U.
	* rcsgen.c: U.
	* rcsmerge.c: U.
	* rcssyn.c: U.
	(Expand): Delete var.
	* rlog.c: U.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move "effective RCS version" into `struct behavior'.

	Here, "U" means "Throughout, use `BE (version)'".
	* rcsbase.h (RCSversion): Delete var decl.
	(behavior): Add `version' to this struct.
	* rcs.c: U.
	* rcsedit.c: U.
	* rcsfcmp.c: U.
	* rcsgen.c: U.
	* rcstime.c: U.
	* rcsutil.c: U.
	(RCSversion): Delete var.
	* rlog.c: U.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use `MANI (filename)' and `MANI (standard_output)'.

	Here, "U" means "Throughout, use `MANI (filename)'
	and `MANI (standard_output)' instead of singular variable names.
	* rcsbase.h (workname, workstdout): Delete #define:s.
	* ci.c: U.
	* co.c: U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsedit.c: U.
	* rcsfnms.c: U.
	* rcskeep.c: U.
	* rcslex.c: U.
	* rcsmerge.c: U.
	* rlog.c: U.

2010-03-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Consolidate RCS file state into `struct repository'.

	Here, "U" means "Throughout, use `REPO (foo)' and
	`ADMIN (foo)' instead of the old singular variable names".
	* rcsbase.h (repository): New struct.
	(repository): New `struct repository' decl.
	(REPO, ADMIN): New macros.
	(RCSname, fdlock, RCSstat, Dbranch, AccessList, Symbols, Comment)
	(Ignored, Locks, Head, TotalDeltas): Delete var decls.
	* ci.c: U.
	* co.c: U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsedit.c: U.
	* rcsfcmp.c: U.
	* rcsfnms.c: U.
	(RCSname, fdlock, RCSstat): Delete vars.
	(repository): New `struct repository'.
	* rcsgen.c: U.
	* rcslex.c: U.
	* rcsmerge.c: U.
	* rcsrev.c: U.
	* rcssyn.c: U.
	(Comment, Ignored, AccessList, Symbols, Locks, Head)
	(Dbranch, TotalDeltas): Delete vars.
	* rlog.c: U.

2010-03-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Define `ruid', `myself' unconditionally.

	* rcsutil.c (ruid): Remove surrounding preproc conditional.
	(ruid) [!HAVE_GETUID]: Abort; programmer error.
	(myself): New func.
	* rcsbase.h (ruid): Declare func unconditionally.
	(myself): New func decl.

2010-03-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Push `#if has_NFS || BAD_UNLINK' for `un_link' out of header.

	* rcsedit.c (un_link): Restructure to use #define:s in code.
	* rcsbase.h (un_link): Remove surrounding preproc conditional,
	including sibling `#if ! (has_NFS || BAD_UNLINK)' block.

2010-03-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Push `#if large_memory' for `editstring' out of header.

	* rcsedit.c (UNUSED_IF_LARGE_MEMORY): New #define.
	(editstring): Use `UNUSED_IF_LARGE_MEMORY' for param `delta';
	remove preproc conditional surrounding func header.
	* rcsbase.h (editstring): Remove surrounding preproc
	conditional, including sibling block `#if large_memory'.

2010-03-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add braces to disambiguate `else' clause.

	* rcsedit.c [!large_memory] (copylines):
	Add braces to disambiguate `else' clause.

2010-03-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Define type for `pairnames' "rcsopen" func.

	* rcsbase.h (open_rcsfile_fn_t): New typedef.
	(pairnames): Use `open_rcsfile_fn_t' in func decl.
	* rcsfnms.c (pairnames): Use `open_rcsfile_fn_t' in arglist.

2010-03-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Dose data structures with `const'.

	* rcsbase.h (ciklog, Keyword, ctab, expand_names, Kaccess)
	(Kauthor, Kbranch, Kcomment, Kdate, Kdesc, Kexpand, Khead)
	(Klocks, Klog, Knext, Kstate, Kstrict, Ksymbols, Ktext)
	(equal_line): Add `const' to var decls.
	* rcsedit.c (ciklog): Add `const' to var definition.
	* rcskeys.c (Keyword): Likewise.
	* rcsmap.c (ctab): Likewise.
	* rcssyn.c (Kaccess, Kauthor, Kbranch, Kcomment, Kdate)
	(Kdesc, Kexpand, Khead, Klocks, Klog, Knext, Kstate)
	(Kstrict, Ksymbols, Ktext, expand_names): Likewise.
	* rcsutil.c (equal_line): Likewise.

2010-03-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Consolidate parse state into `struct parse_state'.

	Here, "U" means "Throughout, use `LEX (foo)' and `NEXT (foo)'
        instead of the old singular variable names".
	* rcsbase.h (parse_state): New struct.
	(parse_state): New `struct parse_state' decl.
	(LEX, NEXT): New macros.
	(NextString, nexttok, nerror, nextc, rcsline): Delete var decls.
	* rcslex.c: U.
	(parse_state): New `struct parse_state'.
	(nexttok, nextc, rcsline, nerror, NextString): Delete vars.
	* ci.c: U.
	* co.c: U.
	* merge.c: U.
	* rcs.c: U.
	* rcsclean.c: U.
	* rcsdiff.c: U.
	* rcsedit.c: U.
	* rcsgen.c: U.
	* rcskeep.c: U.
	* rcsmerge.c: U.
	* rcssyn.c: U.
	* rlog.c: U.

2010-03-23  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Consolidate workfile state into `struct manifestation'.

	* rcsbase.h (manifestation): New struct.
	(manifestation): New `struct manifestation' decl.
	(MANI, workname, workstdout, PREV): New macros.
	(workname, workstdout, prevkeys, prevauthor, prevdate)
	(prevname, prevrev, prevstate): Delete var decls.
	* rcsfnms.c (workname, workstdout): Delete vars.
	(manifestation): New `struct manifestation'.
	(pairnames): Use `PREV (valid)'.
	* rcskeep.c (prevkeys): Delete var.
	(prevauthor, prevdate, prevname, prevrev, prevstate): Likewise.
	(keepdate): Set `PREV (date)' directly.
	(keeprev): Set `PREV (rev)' directly.
	(getoldkeys): Set `PREV (foo)' state; use `PREV (foo)' directly;
	add "consider empty string as not given" processing.
	(main): Use `PREV (rev)', `PREV (date)',
	`PREV (author)', `PREV (name)', `PREV (state)'.
	* rcsrev.c (fexpandsym): Use `PREV (rev)'.
	* ci.c (main): Use `PREV (rev)', `PREV (date)',
	`PREV (author)', `PREV (state)', `PREV (name)'.

2010-03-23  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Add abstraction: fbuf_save

	* rcsbase.h (fbuf_save): New func decl.
	(fstr_save): Delete func decl.
	* rcsutil.c (fbuf_save): New func.
	(fstr_save): Delete func.
	* rcs.c (doassoc): Use `fbuf_save'.
	* rlog.c (getnumericrev): Likewise.
	* rcslex.c (lookup): Don't take `char *'; instead, take
	`struct buf *'; use `fbuf_save'; update callers.
	(nextlex): Use `fbuf_save'.
	(getphrases): Use `strncpy' for saving `key'.

2010-03-22  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Fix cpp conditional regression introduced 2010-02-17.

	This happened as part of the change:
	"[build] Move `getcwd', `getwd' check to configure.in".
	* rcsfnms.c [!GETCWD && !GETWD] (getcwd): Change surrounding
	cpp conditional to this from nonsensical "!GETWD && !GETWD".

2010-03-22  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Make "make test-prep" more robust.

	* Makefile.am (test-prep): Explicitly
	delete $(bin_PROGRAMS) to force relink.

2010-03-20  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Consolidate some global booleans into `struct behavior'.

	Here, "BE" means "Use BE (foo) instead of separate var names".
	* rcsbase.h (behavior): New struct.
	(behavior): New `struct behavior' decl.
	(BE): New macro.
	(locker_expansion, interactiveflag, hshenter)
	(quietflag, StrictLocks): Delete var decls.
	* rcsutil.c (behavior): New `struct behavior'.
	(catchsigaction): Use `BE (quiet)'.
	* ci.c (removelock, addelta, main): BE.
	* co.c (rmworkfile, buildjoin, main): BE.
	* ident.c (scanfile, main): BE.
	* merge.c (main): BE.
	* rcs.c (buildtree, main): BE.
	* rcsclean.c (main): BE.
	* rcsdiff.c (main): BE.
	* rcsedit.c (locker_expansion): Delete var.
	(keyreplace): BE.
	* rcsfnms.c (InitAdmin, main): BE.
	* rcsgen.c (interactiveflag): Delete var.
	(ttystdin, yesorno, putadmin): BE.
	* rcslex.c (hshenter, quietflag): Delete vars.
	(Lexinit, nextlex, warn, rcswarn, workwarn, diagnose): BE.
	[LEXDB] (main): BE.
	* rcsmerge.c (main): BE.
	* rcssyn.c (StrictLocks): Delete var.
	(getadmin, ignorephrases, getdelta): BE.
	* rlog.c (main): BE.

2010-03-19  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Use GNU Automake.

	* Makefile.am: New file.
	* ci.c: Do s/-help.c/.help/ for #include file.
	* co.c: Likewise.
	* ident.c: Likewise.
	* merge.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsmerge.c: Likewise.
	* rlog.c: Likewise.
	* Makefile.in: Delete file.

2010-03-18  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use DIFF_{SUCCESS,FAILURE,TROUBLE} directly.

	Using vars was a temporary measure while fleeing conf.h.

	Here, "U" means "Throughout, use `DIFF_SUCCESS',
	                 `DIFF_FAILURE', `DIFF_TROUBLE' directly".
	* rcsutil.c: U.
	(diff_success, diff_failure, diff_trouble): Delete vars.
	* rcsbase.h (diff_success, diff_failure, diff_trouble):
	Delete var decls.
	* ci.c: U.
	* co.c: U.
	* merge.c: U.
	* merger.c: U.
	* rcs.c: U.
	* rcsdiff.c: U.
	* rcsmerge.c: U.

2010-03-17  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Consolidate parallel rcsedit.c arrays into `struct sff'.

	* rcsedit.c (sff): New struct.
	(SFFI_LOCKDIR, SFFI_NEWDIR, SFF_COUNT): New #define:s.
	(sff): New static array of `struct sff'.
	(lockname, newRCSname): Use `sff'.
	(lockdirtp_index, newRCSdirtp_index, newworkdirtp_index)
	(DIRTEMPNAMES): Delete #define:s.
	(dirtpname, dirtpmaker): Delete data structures.
	(rcswriteopen): Use `sff', `SFFI_LOCKDIR'.
	(keepdirtemp): Use `sff', `SFF_COUNT'.
	(makedirtemp): Use `SFFI_NEWDIR', `sff'.
	(dirtempunlink): Use `SFF_COUNT', `sff'.

2010-03-17  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use `_Exit', which is C99.

	* ci.c (exiterr): Use `_Exit'.
	* co.c (exiterr): Likewise.
	* ident.c (exiterr): Likewise.
	* merge.c (exiterr): Likewise.
	* rcs.c (exiterr): Likewise.
	* rcsclean.c (exiterr): Likewise.
	* rcsdiff.c (exiterr): Likewise.
	* rcsfnms.c [!HAVE_GETWD] (getcwd): Likewise.
	(exiterr): Likewise.
	* rcslex.c [LEXDB] (exiterr): Likewise.
	* rcsmerge.c (exiterr): Likewise.
	* rcsrev.c [REVTEST] (exiterr): Likewise.
	* rcssyn.c [SYNTEST] (exiterr): Likewise.
	* rcsutil.c (write_stderr, runv): Likewise.
	* rlog.c (exiterr): Likewise.

2010-03-17  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Don't do "make distclean" on "make dist"!

	* Makefile.in (distdir, slow, headers)
	(infrastructure, EXTRA_DIST): New vars.
	(dist): New target.

2010-03-17  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Consolidate some program globals into `struct program'.

	Here, "USUAL" means "(cmdid): Delete var.
	                     (exiterr): Make static, declare `exiting'.
	                     (program): New struct instance.";
	and "PARTIAL foo" means "Like USUAL, but with only foo".
	* rcsbase.h (cmdid): Delete var decl.
	(exiterr): Delete func decl.
	(program): New struct.
	(program): New var decl.
	* ci.c: USUAL.
	* co.c: USUAL.
	* gnu-h-v.c (display_version): Use `program.name'.
	(check_hv): Likewise; also don't
	take `help'; use `program.help' instead.
	* gnu-h-v.h (check_hv): Update func decl.
	(CHECK_HV): Update call to `check_hv'.
	* ident.c: USUAL.
	(reportError, scanfile): Use `program.name'.
	* merge.c: USUAL.
	* merger.c (merge): Use `program.exiterr'.
	* rcs.c: USUAL.
	* rcsclean.c: USUAL.
	* rcsdiff.c: USUAL.
	* rcsfcmp.c [FCMPTEST]: PARTIAL cmdid, program.
	* rcsfnms.c [PAIRTEST]: USUAL.
	* rcskeep.c [KEEPTEST]: PARTIAL cmdid, program.
	* rcslex.c (Oerror): Use `program.exiterr'.
	(fatcleanup): Use `program.name', `program.exiterr'.
	(startsay, fatserror): Use `program.name'.
	[LEXDB]: USUAL.
	* rcsmerge.c: USUAL.
	* rcsrev.c [REVTEST]: USUAL.
	* rcssyn.c [SYNTEST]: USUAL.
	* rcsutil.c (catchsigaction): Use `program.exiterr'.
	* rlog.c: USUAL.

2010-03-17  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Avoid `strcpy'.

	* ci.c (incnum): Use `strncpy'.
	* rcsclean.c [HAVE_DIRENT_H] (get_directory): Likewise.
	* rcsdiff.c (main): Likewise.
	* rcsfnms.c (maketemp, bufscat, bufscpy, getfullRCSname): Likewise.
	* rcsutil.c (str_save, fstr_save): Likewise.
	* rlog.c (recentdate, getdatepair): Likewise.
	(KSTRCPY): New macro.
	(getnumericrev, main): Use `KSTRCPY'.

2010-03-16  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use `bool' (and `true' and `false') more.

	Here, "B: foo" means "Change type of foo from `int' to `bool'".
	* rcsbase.h: #include <stdbool.h>.
	(STRICT_LOCKING): Use `true'.
	[!maps_memory] (Igetmore): Update func decl.
	(merge): Update func decl.
	(locker_expansion): Update var decl.
	(rcswriteopen, makedirtemp, addlock, addsymbol, checkaccesslist)
	(dorewrite, expandline, findlock, finishedit, rcsreadopen, pairnames):
	Update func decl.
	(interactiveflag): Update var decl.
	(buildrevision, putdtext, ttystdin, yesorno, putdesc, putdftext):
	Update func decl.
	(prevkeys): Update var decl.
	(getoldkeys): Update func decl.
	(hshenter, quietflag): Update var decl.
	(fatcleanup, eoflex, getkeyopt, getlex, expandsym, fexpandsym):
	Update func decl.
	(StrictLocks): Update var decl.
	(getdiffcmd, getdesc, putstring, getusername, isSLASH): Update func decl.
	* ci.c: Don't #include <stdbool.h>.
	(struct Symrev): B: .override.
	(forceciflag, keepflag, keepworkingfile, rcsinitflag): B: var.
	(addbranch): B: param `removedlock'.
	(addsyms): B: rv.
	(xpandfile): B: param `dolog'.
	(addassoclst): B: param `flag'.
	(main): B: local vars `initflag', `mustread', `lockflag',
	`lockthis', `mtimeflag', `Ttimeflag', `dolog', `newhead',
	`usestatdate', `bad_truncate'.  Also, update interpretation
	of `ftruncate' rv to be `bool'-friendly.
	* co.c: Don't #include <stdbool.h>.
	(forceflag, mtimeflag): B: var.
	(rmworkfile, preparejoin, buildjoin): B: rv.
	(main): B: local vars `tostdout', `Ttimeflag'.
	* ident.c: Don't #include <stdbool.h>.
	* maketime.c (isleap): B: rv.
	(time2tm, tm2time): B: param `localzone'.
	(maketime): B: local var `localzone'.
	* maketime.h (time2tm, tm2time): Update func decls.
	* merge.c: Don't #include <stdbool.h>.
	(main): B: local var `tostdout'.
	* merger.c (merge): B: param `tostdout'.
	* rcs.c: Don't #include <stdbool.h>.
	(struct Symrev): B: .override.
	(chgheadstate, lockhead, unlockcaller, suppress_mail): B: var.
	(getassoclst): B: param `flag'.
	(scanlogtext): B: param `edit'.
	(doaccess): B: rv, local var `changed'.
	(sendmail): B: rv; also, remove spurious parens for `return' "arg".
	(breaklock, branchpoint): B: rv.
	(removerevs): B: rv; use `true', `false'.
	(doassoc): B: rv, local var `changed'.
	(setlock): B: rv; use `false'.
	(dolocks, domessage): B: rv, local var `changed'.
	(rcs_setstate, buildeltatext): B: rv.
	(main): B: local vars `branchflag', `initflag', `textflag',
	`strictlock', `strict_selected', `Ttimeflag', `keepRCStime';
	use `false'.
	* rcsclean.c: Don't #include <stdbool.h>.
	(unlock): B: rv.
	(main): B: local vars `dounlock', `perform', `unlocked', `unlockflag',
	`waslocked', `Ttimeflag'.
	* rcsdiff.c: Don't #include <stdbool.h>.
	(main): B: local var `no_diff_means_no_output'.
	* rcsedit.c: Don't #include <stdbool.h>.
	(locker_expansion): B: var.
	(finishedit): B: param `done'.
	(copystring): B: local var `amidline'.
	(enterstring): B: local vars `amidline', `oamidline'.
	(keyreplace): B: params `delimstuffed', `dolog';
	B: local var `kdelim_found'; use `false'.
	(expandline): B: params `delimstuffed', `dolog'; B: local var `e';
	remove local var `ds'; use `delimstuffed' directly; use `false', `true'.
	(rcswriteopen): B: param `mustread'; local var `waslocked'.
	(makedirtemp): B: param `isworkfile'.
	(findlock): B: param `delete'.
	(addlock): B: param `verbose'.
	(addsymbol): B: param `rebind'.
	(checkaccesslist): B: rv.
	(dorewrite): B: param `lockflag'.
	* rcsfcmp.c: Don't #include <stdbool.h>.
	(rcsfcmp): B: local vars `eqkeyvals', `xeof', `ueof'.
	* rcsfnms.c: Don't #include <stdbool.h>.
	(suffix_matches): B: rv.
	(rcsreadopen): B: param `mustread'.
	(finopen): B: params `rcsopen' 3rd arg, `mustread';
	B: local vars `interesting', `preferold'.
	(fin2open): B: params `rcsopen' 3rd arg, `mustread'.
	(pairnames):  B: params `rcsopen' 3rd arg, `mustread', `quiet';
	B: local var `paired'.
	(isSLASH): B: rv.
	[!HAVE_GETWD] (getcwd): B: local vars `readerror',
	`toolong'; use `true'.
	[PAIRTEST] (main): B: local var `initflag'.
	* rcsgen.c: Don't #include <stdbool.h>.
	(interactiveflag): B: var.
	(scandeltatext): B: param `needlog'.
	(buildrevision): B: param `expandflag'.
	(ttystdin): B: rv, local var `initialized'.
	(yesorno): B: rv.
	(putdesc): B: param `textflag'.
	(getsstdin): B: local var `tty'.
	(putdtext): B: rv, param `diffmt'.
	(putstring): B: params `delim', `log'.
	(putdftext): B: param `diffmt'.
	* rcskeep.c: Don't #include <stdbool.h>.
	(prevkeys): B: var.
	(badly_terminated): B: rv.
	(get0val): B: param `optional', local var `got1'.
	(keepid): B: rv.
	(getval): B: rv, param `optional'.
	(checknum, keeprev): B: rv.
	(getoldkeys): B: rv, local vars
	`needs_closing', `prevname_found'; use `true'.
	* rcslex.c: Don't #include <stdbool.h>.
	(hshenter, quietflag, ignored_phrases): B: vars.
	(eoflex, getlex): B: rv.
	(getkeyopt): B: rv; remove spurious parens around `return' "arg".
	(checkidentifier): B: param `dotok', local var `isid'.
	[!maps_memory && large_memory] (Igetmore): B: rv; use `true', `false'.
	(Oerrloop): B: var.
	(fatcleanup): B: param `already_newline'.
	* rcsmerge.c: Don't #include <stdbool.h>.
	(main): B: local var `tostdout'.
	* rcsrev.c: Don't #include <stdbool.h>.
	(expandsym): B: rv.
	(fexpandsym): B: rv, local var `id'.
	* rcssyn.c: Don't #include <stdbool.h>.
	(StrictLocks): B: var.
	(getkeyval): B: param `optional'.
	(getdelta): B: rv; remove spurious parens around `return' "arg".
	(getdesc): B: param `prdesc'.
	(getdiffcmd): B: param `delimiter'.
	* rcstime.c (use_zone_offset): B: var.
	(date2str): Use `false'.
	* rcsutil.c: Don't #include <stdbool.h>.
	(getusername): B: param `suspicious'.
	(unsupported_SA_SIGINFO): B: var.
	(setup_catchsig): Use `true'.
	(catchints): B: local var `catching_ints'.
	(catchmmapints): B: local var `catching_mmap_ints'.
	(runv) [BAD_WAIT_IF_SIGCHLD_IGNORED]: B: local var `fixed_SIGCHLD'.
	(setRCSversion): B: local var `oldversion'.
	(set_uid_to): B: local var `looping'
	(stick_with_euid): B: var.
	* rlog.c: Don't #include <stdbool.h>.
	(branchflag, lockflag): B: vars.
	(putadelta): B: param `trunk', local var `pre5'.
	(getdatepair): B: local var `switchflag', `eq'.
	(checkrevpair, getnumericrev): B: rv.
	(main): B: local var `descflag', `selectflag', `onlylockflag',
	`onlyRCSflag', `pre5', `shownames'.

2010-03-16  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use `quietflag' more.

	* ident.c (scanfile): Drop arg `quiet'; use `quietflag' instead.
	(main): If given -q, set `quietflag' directly.
	If given -V, return successfully after displaying version info.

2010-03-16  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use enum for keyword substitution mode.

	* rcsbase.h (kwsub): New enum.
	[O_BINARY] (FOPEN_R_WORK, FOPEN_W_WORK, FOPEN_WPLUS_WORK): Use enum.
	(KEYVAL_EXPAND, KEYVALLOCK_EXPAND, KEY_EXPAND, VAL_EXPAND)
	(OLD_EXPAND, BINARY_EXPAND): Delete #define:s.
	(MIN_UNEXPAND, MIN_UNCHANGED_EXPAND): Use enum.
	* ci.c (main) [OPEN_O_BINARY]: Use enum.
	(main): Likewise.
	* co.c (main) [OPEN_O_BINARY]: Likewise.
	(main): Likewise.
	* rcs.c (buildeltatext) [OPEN_O_BINARY]: Likewise.
	* rcsclean.c (main): Likewise.
	* rcsdiff.c (main): Likewise.
	(main) [OPEN_O_BINARY]: Likewise.
	* rcsedit.c (keyreplace): Likewise.
	* rcsfnms.c (InitAdmin): Likewise.
	* rcsgen.c (putadmin): Likewise.
	* rcsmerge.c (main): Likewise.
	* rcssyn.c (getadmin): Likewise.
	* rlog.c (main): Likewise.

2010-03-15  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Don't bother taking unused third arg for `same_file'.

	* rcsbase.h (same_file): Don't take third arg.
	* ci.c (main): Call `same_file' w/o third arg.
	* co.c (main): Likewise.
	* rcsclean.c (main): Likewise.
	* rcsedit.c (chnamemod): Likewise.
	* rcsfnms.c (getfullRCSname): Likewise.

2010-03-15  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Topo-sort top-level; eliminate redundant forward func decls.

	* maketime.c: Delete forward func decls; reorder
	top-level; do other whitespace and comment changes.
	* merger.c: Likewise.
	* partime.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcskeys.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmap.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.

2010-03-15  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Remove spurious debugging output.

	* rcsfnms.c [!HAVE_MKSTEMP] (homegrown_mkstemp):
	Remove debugging output.

2010-03-13  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Revise output for --help option.

	* ci.c (:help comment): Remove description blurb;
	use uppercase letters and a period; flatten/reorg a bit.
	* co.c (:help comment): Likewise.
	* ident.c (:help comment): Likewise.
	* merge.c (:help comment): Likewise.
	* rcs.c (:help comment): Likewise.
	* rcsclean.c (:help comment): Likewise.
	* rcsdiff.c (:help comment): Likewise.
	* rcsmerge.c (:help comment): Likewise.
	* rlog.c (:help comment): Likewise.

2010-03-13  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Topo-sort top-level; eliminate redundant forward func decls.

	* ci.c: Delete forward func decls; reorder top-level;
	do other whitespace and comment changes.
	(main): Move to end.
	* co.c: Likewise.
	* ident.c: Likewise.
	* merge.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsmerge.c: Likewise.
	* rlog.c: Likewise.

2010-03-13  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[sec] Use mktemp(1) instead of homegrown tmporary file naming.

	* rcsfreeze.sh (TMPLOG): Use mktemp(1); exit if not successful.

2010-03-11  Thien-Thi Nguyen  <ttn@gnuvola.org>

	rcsdiff: Refine "same-revision don't call diff" optimization.

	* rcsdiff.c (unique): New struct def.
	(s_unique): New typedef.
	(minus_y, minus_D): New static `s_unique' objects.
	(longopt_maybe_p): New static func.
	(main) <option parsing>: No longer disable "same-revision
	don't call diff" optimization on any long opt.  Instead, disable
	only for `--side-by-side', `--ifdef', or unique portions thereof.
	Reported by Aaron S. Hawley <ashawley@gnu.uvm.edu>.

2010-03-11  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Factor string of '='.

	* rcsbase.h (equal_line): New var decl.
	* rcsutil.c (equal_line): New const string.
	* rcsdiff.c (main): Use `equal_line'.
	* rlog.c (main): Likewise.

2010-03-11  Thien-Thi Nguyen  <ttn@gnuvola.org>

	Document rcsdiff(1) options passed to underyling diff(1).

	* rcsdiff.c (:help comment): Expand.

2010-03-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	rcsdiff: Accept `-U N' to output N lines of unified context.

	* rcsdiff.c (main): Handle option `-U'.

2010-03-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[v] Cause "make check" to fail if any test fails.

	* Makefile.in (check): If any test fails, fail overall.

2010-03-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use '\0' more.

	* ci.c: Throughout, replace `0' a char context with '\0'.
	* co.c: Likewise.
	* merger.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcskeep.c: Likewise.
	* rcslex.c: Likewise.
	* rcsrev.c: Likewise.
	* rcsutil.c: Likewise.

2010-03-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `printf %.2d' check to configure.ac.

	* rcstime.c (proper_dot_2): Rewrite func as simple macro.

2010-03-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use <stdbool.h>.

	* rcsbase.h (true, false): Delete #define:s.
	* ci.c: #include <stdbool.h>.
	* co.c: Likewise.
	* ident.c: Likewise.
	* merge.c: Likewise.
	* rcs.c: Likewise.
	* rcsbase.h: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmerge.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-03-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use `NULL' more.

	* ci.c: Throughout, replace `0' in a pointer context with `NULL'.
	* co.c: Likewise.
	* maketime.c: Likewise.
	* merge.c: Likewise.
	* merger.c: Likewise.
	* partime.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcskeys.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmerge.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-03-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	Fix bug: Remove all log messages when removing all revisions.

	* rcs.c (main): When outdating, allow `scanlogtext' to
	do its job regardless of the presence of revisions finally.
	Reported by Jeff Sheinberg <jeffsh@erols.com>.

2010-03-09  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Do some small changes to quieten GCC warnings.

	* ci.c: #include <ctype.h>.
	* gnu-h-v.c (display_version): Don't take CMDID; use global.
	(check_hv): Don't take CMDID; update call to `display_version'.
	* gnu-h-v.h (display_version, check_hv): Update func decls.
	(CHECK_HV): Update call to `check_hv'.
	* ident.c (main): Update call to `display_version'.
	* maketime.c: #include "rcsbase.h";
	remove vestigal "#if has_conf_h #else ... #endif" block.
	[TEST]: Use `#ifdef', not `#if'.
	* merge.c (main): Update call to `display_version'.
	* partime.c: #include "rcsbase.h";
	remove vestigal "#if has_conf_h #else ... #endif" block.
	(isdigit): Delete #undef, #define.
	(parzone, partime): Change return type to `char const*'.
	* partime.h (partime, parzone): Update func decls.
	* rcsbase.h (O_BINARY): Use "#ifdef", not "#if".
	(isdigit): Delete #define.
	* rcsfcmp.c: Whitespace munging; nfc.
	* rcskeep.c: #include <ctype.h>.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcsutil.c: Likewise.
	(setRCSversion): Update call to `display_version'.

2010-03-09  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Ensure `parse_decimal' never leaves junk fraction.

	* partime.c (parse_decimal): Make sure
	out-param `fres' always contains a valid value.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Delete src/foo-help.c files on "make clean".

	* Makefile.in (clean): Also delete *-help.c.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Add abstraction: gr_revno

	* rcsbase.h (gr_revno): New func decl.
	* rcsrev.c (gr_revno): New func.
	(branchtip): Use it.
	* ci.c: Replace `genrevs (foo, NULL, NULL, NULL, bar)'
	with `gr_revno (foo, bar)', throughout.
	* co.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsmerge.c: Likewise.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Use `NULL' more.

	* ci.c: Throughout, replace `(foo *) 0' with `NULL'.
	* co.c: Likewise.
	* ident.c: Likewise.
	* maketime.c: Likewise.
	* merger.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmerge.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[v] Add basic "make check" support.

	* rcsutil.c: Don't #include "bother.h".
	(prog_co, prog_merge): Delete var definitions.
	* Makefile.in (PATHPREFIX): New var.
	(TESTS_ENVIRONMENT, TESTS): Likewise.
	(RCSPREFIX): Delete var.
	(all): Remove bother.h from dependency list.
	(check): New target.
	(RCSTEST): Delete var.
	(installcheck): Depend on `test-prep'; redirect to `check'.
	(installdebug): Delete target.
	(test-clean): New target.
	(clean): Depend on `test-clean'.
	(distclean): Delete bother.c, not bother.h.
	(rcsutil$o): Delete dependency on bother.h.
	(bother.h): Delete target.
	(bother.c): New target.
	(PARTS): Add `bother$o'.
	(test-prep, xorlf): New targets.
	* alive.test: Rename from rcstest; make sensitive
	to env var DEBUG; don't compile a "fake tr"; chmod -x.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Avoid comparing signed/unsigned.

	* rcsedit.c (deletelines): Take `unsigned long' (both args).
	Also, use `unsigned long' for local var.
	(insertline): Change type of first arg to `unsigned long'.
	(resolve_symlink): Use `ssize_t' for local var.
	* rcsfnms.c (pairnames): Add cast to `size_t' for `strlen' rv.
	Also, transform `baselen' comparison algebraically.
	* rcslex.c (fd2RILE): Use `off_t' for local var.
	* rcsutil.c (write_stderr): Use `int' for local var.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add do-while for `aputc_'; rename.

	* rcsbase.h (aputc): Rename from `aputc_'; add do-while.
	(GETC): Use `aputc'.
	* rcsedit.c (snapshotline, copylines, copystring, editstring)
	(expandline, escape_string): Likewise.
	* rcsgen.c (putdesc, putadmin, putstring, putdftext): Likewise.
	* rcslex.c (eoflex, getphrases)
	(getphrases, printstring, diagnose): Likewise.
	* rlog.c (main): Likewise.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add do-while for `Igeteof_'; rename.

	* rcsbase.h (Igeteof): Rename from `Igeteof_'; add do-while.
	[large_memory] (Iget): Use `Igeteof'.
	[!large_memory] (cachegeteof): Likewise.
	* rcsedit.c (editstring): Likewise.
	* rcsfcmp.c (discardkeyval, rcsfcmp): Likewise.
	* rcskeep.c (getoldkeys, getval)
	(get0val, keepdate, keepid): Likewise.

2010-03-08  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add do-while for `Iget_'; rename.

	* rcsbase.h (Iget): Rename from `Iget_'; add do-while.
	[!large_memory] (cacheget): Use `Iget'.
	* rcslex.c (Lexinit): Likewise.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add do-while for `cachegeteof_'; rename.

	* rcsbase.h (cachegeteof): Rename from `cachegeteof_'; add do-while.
	[large_memory] (cacheget): Use `cachegeteof'.
	* rcsedit.c (copylines, expandline): Likewise.
	* rcsgen.c (putdftext): Likewise.
	* rcslex.c (eoflex): Likewise.
	* rcssyn.c (getdiffcmd): Likewise.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add do-while for `cacheunget_'; rename.

	* rcsbase.h (cacheunget): Rename from `cacheunget_'; add do-while.
	* rcsedit.c (keyreplace): Use `cacheunget'.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add do-while for `cacheget_'; rename.

	* rcsbase.h (cacheget): Rename from `cacheget_'; add do-while.
	(cacheunget_, GETC): Use `cacheget'.
	* rcsedit.c (keyreplace): Likewise.
	* rcslex.c (getphrases, printstring): Likewise.
	* rcssyn.c (getdiffcmd): Likewise.
	* rlog.c (getscript): Likewise.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int C] Add do-while for `GETC_'; rename to `GET'.

	* rcsbase.h (GETCeof_): Delete unused macro.
	(GETC): Rename from `GETC_'; add do-while.
	* rcsedit.c (copystring): Use `GETC'.
	(enterstring, editstring, expandline): Likewise.
	* rcslex.c (nextlex, getphrases, readstring, savestring): Likewise.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Mark some parameters RCS_UNUSED.

	* rcsfnms.c (rcsreadopen): Mark `mustread' RCS_UNUSED.
	* rcslex.c (nothing_to_deallocate): Likewise for `f'.
	* rcsutil.c (catchsigaction): Likewise for `c'.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Add check for GCC attribute `unused'.

	* rcsbase.h (RCS_UNUSED): New #define.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Declare `display_version' for rcsutil.c.

	* rcsutil.c: #include "gnu-h-v.h".

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move all DIFF* config to configure.in; assume diffutils.

	* Makefile.in (DIFF, DIFF3): Delete vars.
	(RCSTEST): Remove DIFF='$(DIFF)'.
	(bother.h): Don't output #define:s for `DIFF', `DIFF3'.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Require absolute filenames for external programs.

	* Makefile.in (absp): Delete var.
	(bother.h): Use absolute $(RCSPREFIX), via pwd(1);
	don't bother computing `ALL_ABSOLUTE', `DIFF_ABSOLUTE'.
	* rcsutil.c (exec_RCS): Move #define out of conditional.
	(set_uid_to): Update #if condition, taking DIFF_ABSOLUTE as 1.

2010-03-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move non-filename DIFF* configuration to configure.in.

	* merger.c: Don't #include "bother.h".
	* rcsdiff.c: Likewise.
	* Makefile.in (DIFF3_BIN, DIFFFLAGS, DIFF_L)
	(DIFF_FAILURE, DIFF_SUCCESS, DIFF_TROUBLE): Delete vars.
	(merger$o, rcsdiff$o): No longer depend on "bother.h".
	(bother.h): Remove #define generation for `DIFF_L', `DIFF3_BIN',
	`DIFFFLAGS', `DIFF_SUCCESS', `DIFF_FAILURE', `DIFF_TROUBLE'.

2010-03-06  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `SENDMAIL' configuration to configure.in.

	* rcs.c: Don't #include "bother.h".
	* Makefile.in (SENDMAIL): Delete var.
	(rcs$o): No longer depend on "bother.h".
	(bother.h): Remove `SENDMAIL' #define/#undef generation.

2010-03-06  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `ED' configuration into configure.in.

	* Makefile.in (ED): Delete var.
	(bother.h): Remove `ED' #define.
	Also, don't bother checking it for absoluteness.
	* merger.c (merge): Use `ED'.
	* rcsbase.h (prog_ed): Delete var decl.
	* rcsutil.c (prog_ed): Delete var.

2010-03-06  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `COMPAT2' configuration into configure.in.

	* Makefile.in (COMPAT2): Delete var.
	(bother.h): Remove `COMPAT2' #define/#undef generation.
	(rcssyn$o): No longer depend on "bother.h".
	* rcssyn.c: Don't #include "bother.h".

2010-03-06  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[dist] Don't distribute INSTALL.RCS.

	* Makefile.in: Comment munging; nfc.
	* rcsbase.h: Likewise.

2010-03-06  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[sec] Use `mkstemp' instead of `mktemp'.

	* rcsbase.h (P_tmpdir): New #define, but only not already.
	(set_temporary_file_name): New func decl.
	* rcsfnms.c: #include <stdint.h>.
	[HAVE_MKTEMP] (tmp): Delete func and surrounding #ifdef.
	[!HAVE_MKSTEMP] (homegrown_mkstemp): New func.
	[!HAVE_MKSTEMP] (mkstemp): #define to `homegrown_mkstemp'.
	(set_temporary_file_name): New func.
	(maketemp): Use `set_temporary_file_name'.
	* rcsedit.c (makedirtemp): Use `set_temporary_file_name'.

2010-03-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	Add --help, --version handling for all programs.

	In the following, for program source PROG.c:
	Implicit: #include "ci-help.c"; add /*:help ...*/ comment.
	C means: Check for "--help" and "--version"; handle them.
	B means: Don't display usage summary on bad option.
	* gnu-h-v.h: New file.
	* gnu-h-v.c: New file.
	* ci.c (main): C; B.
	* co.c (main): C; B.
	* ident.c (main): C; use `display_version'.
	* merge.c (main): Likewise.
	* rcs.c (main): C; B.
	* rcsclean.c (main): C.
	* rcsdiff.c (main): C; B.
	* rcsfreeze.sh: Add copyright and license notices.
	Add handling for --help, --version.
	(version): New var.
	(usage): New func.
	* rcsmerge.c (main): C; B.
	* rcsutil.c (setRCSversion): Use `display_version'.
	* rlog.c (main): C; B.
	* rcsbase.h (COMMAND_VERSION): Delete macro.
	* Makefile.in (%-help.c : %.c): New pattern rule.
	(SOURCE): Add gnu-h-v.c.
	(PARTS): Add gnu-h-v$o.
	(ci$o): Depend on ci-help.c.
	(co$o): Depend on co-help.c.
	(ident$o): Depend on ident-help.c.
	(merge$o): Depend on merge-help.c.
	(rcs$o): Depend on rcs-help.c.
	(rcsclean$o): Depend on rcsclean-help.c.
	(rcsdiff$o): Depend on rcsdiff-help.c.
	(rcsmerge$o): Depend on rcsmerge-help.c.
	(rlog$o): Depend on rlog-help.c.

2010-03-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move some Makefile vars out of "tailorable" section.

	* Makefile.in (bindir): Move up; use @bindir@ directly.
	(x): Move up; use @EXEEXT@.
	(o): Move up; use .@OBJEXT@ -- NB leading dot.
	(LIBOBJS): Move up; use @LIBOBJS@.

2010-03-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Use an object archive instead of specifying long lists.

	* Makefile.in (LINK): Remove $(LDFLAGS), $(CFLAGS).
	(clean): Don't delete a.*, RCS/a.*; instead delete librcsparts.a.
	(ci, ci$x): Delete this var and pattern rule, respectively.
	(co, co$x): Likewise.
	(ident, ident$x): Likewise.
	(merge, merge$x): Likewise.
	(rlog, rlog$x): Likewise.
	(rcs, rcs$x): Likewise.
	(rcsclean, rcsclean$x): Likewise.
	(rcsdiff, rcsdiff$x): Likewise.
	(rcsmerge, rcsmerge$x): Likewise.
	(%$x : %$o): New pattern rule.
	(PROGS, PARTS): New vars.
	(OBJECT): Rewrite var in terms of $(PROGS), $(PARTS).
	(librcsparts.a): New target.

2010-03-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Make compilation output file a little more obvious.

	* Makefile.in (.c$o): Add "-o $@" to compile command line.
	(ci$x, co$x, ident$x, merge$x, rlog$x, rcs$x)
	(rcsclean$x, rcsdiff$x, rcsmerge$x): Move "-o $@"
	forward in the command line, following $(LINK).

2010-03-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Reduce dependency-transitivity of src/Makefile variables.

	* Makefile.in (ALL_CFLAGS): Remove -Dhas_conf_h.
	(all): Depend on bother.h.
	(clean): Remove conf.err from list of files to delete.
	(distclean): Don't delete conf.h; delete bother.h, instead.
	(conf.h): Delete target.
	(merger$o): Depend explicitly on bother.h.
	(rcs$o, rcsdiff$o, rcssyn$o, rcsutil$o): Likewise.
	(absp): New var.
	(bother.h): New target.
	(conf_h): Delete var.
	($(OBJECT)): Don't depend on $(conf_h).
	(FORCE): New target.
	* rcsbase.h: Don't #include "conf.h".
	#include <errno.h>, <stdio.h>, <time.h>, <sys/types.h>,
	<sys/stat.h>, <stdlib.h>, <stdarg.h>, <string.h>.
	[HAVE_FCNTL_H]: #include <fcntl.h>
	[HAVE_LIMITS_H]: #include <limits.h>
	[HAVE_MACH_MACH_H]: #include <mach/mach.h>.
	[HAVE_NET_ERRNO_H]: #include <net/errno.h>.
	[HAVE_PWD_H]: #include <pwd.h>.
	[HAVE_SIGINFO_H]: #include <siginfo.h>.
	[HAVE_SIGNAL_H]: #include <signal.h>.
	[HAVE_SYS_MMAN_H]: #include <sys/mman.h>.
	[HAVE_SYS_WAIT_H]: #include <sys/wait.h>.
	[HAVE_UCONTEXT_H]: #include <ucontext.h>.
	[HAVE_UNISTD_H]: #include <unistd.h>.
	[HAVE_UTIME_H]: #include <utime.h>.
	[HAVE_VFORK_H]: #include <vfork.h>.
	(exiting, printf_string, printf_string_exiting): New macros.
	(FOPEN_RB, FOPEN_R_WORK, FOPEN_WB, FOPEN_W_WORK, FOPEN_WPLUS_WORK)
	(OPEN_O_BINARY, OPEN_CREAT_READONLY, OPEN_O_LOCK, OPEN_O_WRONLY)
	(getlogin_is_secure, bad_NFS_rename, has_setreuid, needs_getabsname)
	(has_NFS, RCS_SHELL, large_memory, TMPDIR, SLASH, SLASHes)
	(ROOTPATH, X_DEFAULT, TZ_must_be_set): Likewise.
	(exec_RCS, EXIT_TROUBLE): Delete macros.
	(isSLASH): New func decl.
	(prog_co, prog_co, prog_merge, prog_diff, prog_diff3, diff_flags)
	(diff_success, diff_failure, diff_trouble, prog_ed): New var decls.
	* rcsutil.c: #include "bother.h".
	(prog_co, prog_merge, prog_diff, prog_diff3, diff_flags)
	(diff_success, diff_failure, diff_trouble, prog_ed): New vars.
	(write_error): Use `diff_trouble'.
	(exec_RCS): New macro, moved from rcsbase.h.
	(runv): Use `diff_trouble'.
	* ci.c (main): Use `prog_diff', `diff_flags', `diff_trouble'.
	* co.c (buildjoin): Use `prog_co', `prog_merge', `diff_trouble'.
	* merge.c (exiterr): Use `diff_trouble'.
	* merger.c: #include "bother.h".
	(merge): Use `prog_diff3', `diff_trouble', `diff_failure',
	`prog_diff', `diff_success', `prog_ed'.
	* rcs.c: #include "bother.h".
	(buildeltatext): Use `prog_diff', `diff_flags', `diff_trouble'.
	* rcsdiff.c: #include "bother.h".
	(main): Use `diff_success', `prog_diff', `prog_co', `diff_trouble',
	`diff_failure'.
	(cleanup, exiterr): Use `diff_trouble'.
	* rcsfnms.c (isSLASH): Define func unconditionally.
	(isSLASH) [!WOE]: Just check that the char is `SLASH'.
	* rcsmerge.c (co): Delete var.
	(main): Use `prog_co', `diff_trouble'.
	(exiterr): Use `diff_trouble'.
	* rcssyn.c: #include "bother.h".
	* conf.heg: Delete file.
	* conf.sh: Delete file.

2010-03-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Detect "absolute-filename-p" without compiling.

	* conf.sh: Use `WOE' value from auto-sussed.h directly to select
	set of #define values.  For `ALL_ABSOLUTE', `DIFF_ARBITRARY'
	computation, use ../build-aux/abs-p.

2010-03-02  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "// is /" check to configure.in.

	* conf.sh: Remove "// is /" check.
	* rcsfnms.c: Do s/SLASHSLASH_is_SLASH/SLASHSLASH_IS_SLASH/g.
	Also, don't bother checking if SLASHSLASH_IS_SLASH is defined.

2010-03-02  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "bad wait if SIGCHLD ignored" check to configure.in.

	* rcsfnms.c: Do s/bad_wait_if_SIGCHLD_ignored/BAD_WAIT_IF_SIGCHLD_IGNORED/g.
	* rcsutil.c: Likewise.
	* conf.sh: Remove "bad wait if SIGCHLD ignored" check.

2010-03-02  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move mmap-related checks to configure.in.

	* rcslex.c: Do s/has_madvise/defined HAVE_MADVISE/g; do
	s/has_mmap/defined HAVE_MMAP/g; do s/mmap_signal/MMAP_SIGNAL/g.
	* rcsutil.c: Likewise.
	* rcsbase.h: Likewise, but if `MMAP_SIGNAL'
	is 0, #undef `HAVE_MMAP', `HAVE_MADVISE' first.
	* conf.sh: Remove mmap-related checks.

2010-03-02  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "bad rename" checks to configure.in.

	* rcsedit.c: Do s/bad_a_rename/BAD_A_RENAME/g;
	do s/bad_b_rename/BAD_B_RENAME/g.
	* conf.sh: Remove "bad rename" checks.

2010-03-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `sys_siglist' check to configure.in.

	* rcsbase.h (sys_siglist): Remove array decl.
	* rcsutil.c: Do s/has_sys_siglist/defined HAVE_SYS_SIGLIST/g.
	* conf.sh: Remove `sys_siglist' check, and also
	for supporting shell vars `has_signal', `has_psignal'.

2010-03-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "siginfo_t .si_errno" check to configure.in.

	* rcsutil.c: Do s/has_si_errno/defined HAVE_SI_ERRNO/g.
	* conf.sh: Remove "siginfo_t .si_errno" check.

2010-03-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "unlink on unwritable files" check to configure.in.

	* rcsbase.h: Do s/bad_unlink/BAD_UNLINK/g.
	* rcsedit.c: Likewise.
	* conf.sh: Remove "unlink on unwritable files" check.

2010-03-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "fopen w+ truncates" check to configure.in.

	* rcsedit.c: Do s/bad_fopen_wplus/BAD_FOPEN_WPLUS/g.
	* conf.sh: Remove "fopen w+ truncates" check.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "signal zaps handler" check to configure.in.

	* rcsutil.c: Do s/sig_zaps_handler/SIG_ZAPS_HANDLER/g.
	* conf.sh: Remove "signal zaps handler" check.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "fflush input" check to configure.in.

	* ci.c: Do s/has_fflush_input/CAN_FFLUSH_IN/g.
	* conf.sh: Remove "fflush input" check.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move "`write' after `creat (F, 0)'" check to configure.in.

	* rcs.c: Do s/bad_creat0/BAD_CREAT0/g.
	* rcsedit.c: Likewise.
	* rcsgen.c: Likewise.
	* conf.sh: Remove "write after creat0 fails" check.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `psiginfo' check to configure.in.

	* rcsutil.c: Do s/has_psiginfo/defined HAVE_PSIGINFO/g.
	* conf.sh: Remove check for `psiginfo'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Drop support for "spawn" (fork(2) analog).

	* rcsbase.h: For #if has_spawn FOO #else BAR #endif
	block, delete everything except BAR.
	* rcsutil.c [has_spawn] (redirect): Delete func.
	Also: delete #if has_spawn FOO #endif blocks;
	where there is `has_spawn', subtitute w/ 0 and simplify.
	* conf.sh: Don't define `has_spawn'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Drop support for "map_fd" (HPUX mmap(2) precursor).

	* rcsbsae.h (maps_memory): Do s/has_map_fd/0/.
	* rcslex.c [has_map_fd] (map_fd_deallocate): Delete func.
	(fd2RILE) [has_map_fd]: Delete allocation sequence.
	* conf.sh: Don't check for "map_fd"; don't define `has_map_fd'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Move check for proper `printf' "%.2" behavior to runtime.

	* rcstime.c (proper_dot_2): New static func.
	(time2date): For #if has_printf_dot FOO #else BAR #endif
	blocks, replace with `proper_dot_2 (FOO, BAR)'.
	* conf.sh: Remove check for proper `printf' "%.2" behavior.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume <limits.h> defines `LONG_MAX'.

	* conf.sh: Remove computation of `LONG_MAX'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `sigblock' check to configure.in.

	* rcsutil.c: Do s/has_sigblock/defined HAVE_SIGBLOCK/g;
	* conf.sh: Remove check for `sigblock'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] When using `sigblock', compute `sigmask' manually.

	* rcsutil.c [has_sigblock] (setup_catchsig): Don't
	use `sigmask; instead, do the subtract and shift manually.
	* conf.sh: Remove computation of `sigmask'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `sigaction' check to configure.in.

	* rcsutil.c: Do s/has_sigaction/defined HAVE_SIGACTION/g.
	* conf.sh: Remove check for `sigaction'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume `sigaction.sa_sigaction' is POSIX.

	* rcsutil.c: For #if has_sa_sigaction FOO #else
	BAR #endif block, delete everything except FOO.
	* conf.sh: Remove check for `sigaction.sa_sigaction'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `psignal' check to configure.in.

	* rcsutil.c: Do s/has_psignal/defined HAVE_PSIGNAL/g.
	* conf.sh: Remove check for `psignal'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume <utime.h> declares `struct utimbuf'.

	* rcsbase.h [!has_utimbuf] (utimbuf): Delete struct decl.
	* conf.sh: Remove check for `struct utimbuf'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume availability of `chmod'.

	* ci.c: For #if bad_chmod_close FOO #else BAR #endif
	block, delete everything except BAR.
	* conf.sh: Remove check for `chmod'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `seteuid', `setuid' checks to configure.in.

	* rcsbase.h: Do s/has_seteuid/defined HAVE_SETEUID/g;
	do s/has_setuid/defined HAVE_SETUID/g.
	* ci.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsutil.c: Likewise.
	* conf.sh: Remove checks for `seteuid', `setuid'.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `ftruncate' check to configure.in.

	* ci.c: Do s/has_ftruncate/defined HAVE_FTRUNCATE/g.
	* conf.sh: Remove check for `ftruncate'.

2010-02-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `vfork', `fork' checks to configure.in.

	* rcsbase.h: Do s/has_fork/defined HAVE_WORKING_FORK/g;
	do s/has_vfork/defined HAVE_WORKING_VFORK/g.
	* rcsutil.c: Likewise.
	* conf.sh: Remove checks for `vfork', `fork'.
	Do s/has_fork/defined HAVE_WORKING_FORK/g.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `waitpid' check to configure.in.

	* rcsfnms.c: Do s/has_waitpid/defined HAVE_WAITPID/g.
	* rcsutil.c: Likewise.
	* conf.sh: Remove check for `waitpid'.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Use `HAVE_SIGNAL_H' directly.

	* rcsbase.h: Do s/has_signal/defined HAVE_SIGNAL_H/g.
	* rcsutil.c: Likewise.
	* conf.sh: Don't propagate `has_signal' to conf.h.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `mktemp' check to configure.in.

	* rcsedit.c: Do s/has_mktemp/defined HAVE_MKTEMP/g.
	* rcsfnms.c: Likewise.
	* conf.sh: Remove check for `mktemp'.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `getuid', `getpwuid' checks to configure.in.

	* rcsbase.h: Do s/has_getuid/defined HAVE_GETUID/g.
	* ci.c: Likewise.
	* rcsutil.c: Likewise; also s/has_getpwuid/defined HAVE_GETPWUID/g.
	* conf.sh: Remove checks for `getuid', `getpwuid'.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `fchmod' check to configure.in.

	* ci.c: Do s/if has_fchmod/ifdef HAVE_FCHMOD/g.
	* rcsedit.c: Likewise.
	* conf.sh: Remove check for `fchmod'.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `getcwd', `getwd' check to configure.in.

	* rcsfnms.c: Do s/has_getcwd/defined HAVE_GETCWD/g;
	do s/has_getwd/defined HAVE_GETWD/g.
	* rcsbase.h (getcwd, getwd): Delete func decls.
	* conf.sh: Remove checks for `getcwd', `getwd'.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move `readlink' check to configure.in; use _POSIX_SYMLOOP_MAX.

	* rcsedit.c: Do s/#if has_readlink/#ifdef HAVE_READLINK/g.
	[HAVE_READLINK] (resolve_symlink): Use `_POSIX_SYMLOOP_MAX'.
	Also, assume `EINVAL' for error-on-non-symlink situation.
	* conf.sh: Remove "check" for <sys/param.h>; remove check
	for `readlink' and its error-on-non-symlink return value.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move a mass of boilerplate from conf.sh to rcsbase.h.

	In the process, we also remove (by selectively not copying)
	redundant func decls meant to augment missing entries in
	<stdio.h>, <stdlib.h>, <string.h>, <time.h>.

	* rcsbase.h: Add boilerplate code.
	* conf.sh: Delete eof boilerplate; don't bother doing the
	"Comment out lines in a.ha that the compiler rejects" step.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move checks for missing type definitions to configure.in.

	* conf.sh Remove checks for missing type definitions;
	instead, grep auto-sussed.h directly.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Presume `fread' rv and arg types are both `size_t'.

	* rcslex.c (Igetmore): Use `size_t' and `fread' directly.
	* rcsutil.c (fastcopy): Likewise.
	(awrite): Use `fwrite' directly.
	* rcsbase.h (Fread, Fwrite): Delete macros.
	* conf.sh: Remove checks for `fread' rv type, arg type.

2010-02-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Presume <stdio.h> provides `rename', `strchr', `strrchr'.

	* rcsedit.c [!has_rename] (do_link): Delete macro, func.
	(chnamemod): Move code out of #if has_rename block,
	deleting #else block as well; simplify #if expression.
	* conf.sh: Remove checks for `rename', `strchr', `strrchr'.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Assume signal handlers return `void'.

	* rcsutil.c: Do s/signal_type/void/g.
	* conf.sh: Remove check for signal handler rv type.
	Also, remove checks for kill(2); replace
	callers with use `raise (getpid (), ...)'.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Presume availability of `fputs'.

	* rcslex.c (aputs): Move code out
	of #if has_fputs; delete #else block.
	* conf.sh: Remove check for `fputs'.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move checks for GCC __attribute__ handling to configure.in

	* conf.sh: Remove checks for GCC attributes `noreturn' and
	`format_printf'; use `GCC_HAS_ATTRIBUTE_NORETURN' and
	`GCC_HAS_ATTRIBUTE_FORMAT' from auto-sussed.h directly.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Assume `EXIT_FAILURE' works.

	* conf.sh: Remove check for `EXIT_FAILURE'.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Presume availability of `vfprintf'.

	* rcslex.c (fvfprintf): Move code in #if has_vfprintf
	block up; delete #else block.
	* conf.sh: Remove checks for `vfprintf', `_doprintf', `_doprnt'.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Assume `malloc' returns `void *'.

	* rcsbase.h: Do s/malloc_type/void */g.
	* rcsfnms.c: Likewise.
	* rcsutil.c: Likewise.
	* conf.sh: Remove check for `malloc' rv type.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Assume `closedir' (from <dirent.h>) returns `int'.

	* rcsclean.c [HAVE_DIRENT_H]: #include <dirent.h>.
	(get_directory): For both func decl and function definition, move
	out of #if has_dirent block and into "ifdef HAVE_DIRENT_H" block.
	Also, assume unconditionally that `closedir' returns `int'.
	(main): Use #ifdef HAVE_DIRENT_H instead of #if has_dirent.
	* conf.sh: Remove checks for <dirent.h>, `closedir' rv.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Presume availability of `memcmp', `memcpy', `memmove'.

	* rcsedit.c (movelines): Move #define to top-level out of
	"#if has_memmove" block, deleting the #else /*!has_memmove */ block.
	* rcsutil.c [!has_memcmp] (memcmp): Delete func.
	[!has_memcpy] (memcpy): Likewise.
	* conf.sh: Remove checks for `memcmp', `memcpy', `memmove'.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move check for system headers into configure.in.

	* conf.sh: Arrange to #include unconditionally <sys/types.h>,
	<sys/stat.h>, <stdlib.h>, <string.h>.  Convert checks for
	system headers from compiler-based to grep auto-sussed.h.
	Likewise for <sys/param.h>; re-#define/use HAVE_SYS_PARAM_H.
	Remove handling for <errno.h> that doesn't declare `errno'.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] To return from `main', use `return' directly.

	* ci.c (main): Use `return', not `exitmain'.
	* co.c (main): Likewise.
	* ident.c (main): Likewise.
	* merge.c (main): Likewise.
	* rcs.c (main): Likewise.
	* rcsclean.c (main): Likewise.
	* rcsdiff.c (main): Likewise.
	* rcskeep.c (main): Likewise.
	* rcslex.c (main): Likewise.
	* rcsmerge.c (main): Likewise.
	* rcsrev.c (main): Likewise.
	* rcssyn.c (main): Likewise.
	* rlog.c (main): Likewise.
	* conf.sh: Remove section probing validity of
	`return' from `main'.  Also, do s/exitmain/return/g.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Add braces to disambiguate `else' clause.

	* ci.c (removelock): Add braces to disambiguate `else'.
	* ident.c (main): Likewise.
	* rcs.c (dolocks, setlock, rcs_setstate): Likewise.
	* rcsdiff.c (main) [DIFF_L]: Likewise.
	* rcsedit.c (keyreplace, addlock, addsymbol, dorewrite): Likewise.
	* rcsgen.c (getsstdin): Likewise.
	* rcsrev.c (fexpandsym): Likewise.
	* rlog.c (putadelta): Likewise.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Presume availability of <stdarg.h>.

	* rcsgen.c (yesorno): Use `va_start' directly.
	* rcslex.c (error, rcserror, workerror, fatserror, faterror)
	(rcsfaterror, warn, rcswarn, workwarn, diagnose, aprintf): Likewise.
	* rcsutil.c (run): Likewise.
	* conf.sh: Remove section probing <stdarg.h>;
	arrange to #include <stdarg.h> unconditionally in conf.h.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Define `cmdid', `main' directly.

	* ci.c (cmdid, main): Define directly.
	* co.c (cmdid, main): Likewise.
	* ident.c (cmdid, main): Likewise.
	* merge.c (cmdid, main): Likewise.
	* rcs.c (cmdid, main): Likewise.
	* rcsclean.c (cmdid, main): Likewise.
	* rcsdiff.c (cmdid, main): Likewise.
	* rcsmerge.c (cmdid, main): Likewise.
	* rlog.c (cmdid, main): Likewise.
	* rcsbase.h (mainProg): Delete macro.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Say "register int c", not just "register c".

	* rcxlex.c (nextlex, readstring)
	(printstring, savestring): Say "register int c".
	* rcsedit.c (copystring, expandline): Likewise.
	* rcs.c (getaccessor, getstates): Likewise.
	* rcsdiff.c (main): Likewise.
	* rlog.c (getauthor): Likewise.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Use Standard C syntax for function definitions.

	* ci.c: Throughout, use Standard C syntax for function definitions.
	* co.c: Likewise.
	* ident.c: Likewise.
	* maketime.c: Likewise.
	* merge.c: Likewise.
	* merger.c: Likewise.
	* partime.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcskeys.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmerge.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-02-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Use ANSI prototypes.

	Abbreviations:
	D: "Don't use `P (PROTOTYPE)', just use PROTOTYPE directly."
	P: "For #if has_prototypes FOO #else BAR #endif blocks,
	replace block with simply FOO."

	* maketime.h (__MAKETIME_P): Delete macro;
	update callers to use its arg directly.
	* partime.h (__PARTIME_P): Likewise.
	* ci.c: D; P.
	* co.c: D.
	* ident.c: D.
	* maketime.c: D.
	* merge.c: D.
	* merger.c: D.
	* partime.c: D.
	* rcs.c: D.
	* rcsbase.h: D.
	* rcsclean.c: D.
	* rcsdiff.c: D.
	* rcsedit.c: D; P.
	* rcsfcmp.c: D.
	* rcsfnms.c: D.
	* rcsgen.c: D; P.
	* rcskeep.c: D.
	* rcslex.c: D; P.
	* rcsrev.c: D.
	* rcssyn.c: D.
	* rcstime.c: D.
	* rcsutil.c: D; P.
	* rlog.c: D.
	* conf.sh: Don't compute `has_prototypes' or `P'.
	Also fix buglet: Use `$ech' instead of `echo'.

2010-02-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Move authoritative version number into configure.in.

	* rcsbase.h: #include "auto-sussed.h".
	(RCS_version_string): Delete decl.
	(COMMAND_VERSION): New #define.
	* ident.c (main): Use `COMMAND_VERSION'.
	* merge.c (main): Likewise.
	* rcsutil.c (setRCSversion): Likewise.
	* Makefile.in (SOURCE): Remove version.c.
	(ci, co, ident, merge, rlog, rcs, rcsclean)
	(rcsdiff, rcsmerge, OBJECT): Remove `version$o'.
	* version.c: Delete file.

2010-02-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Drop "make lint" support.

	* rcsbase.h [RCS_lint] (lintalloc): Delete var.
	[RCS_lint] (mainProg, ftnalloc, tnalloc, trealloc, tfree):
	Remove macro definitions; promoting non-RCS_lint to top-level.
	* ci.c [RCS_lint] (exiterr): Delete #define.
	* co.c: Likewise.
	* ident.c: Likewise.
	* merge.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsmerge.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.
	* rcs.c [RCS_lint] (cmdid, go, main):
	Delete var, #define, and func, respectively.
	* Makefile.in (lint): Delete target.

2010-02-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	Don't coddle compilers that require `(void) EXPRESSION;'.

	* conf.sh: Remove check for `(void) EXPRESSION;' requirement.
	Don't #define `VOID'.
	* conf.heg: Don't #define `VOID'.
	* ci.c: Throughout, remove "VOID " in front of expressions.
	* co.c: Likewise.
	* ident.c: Likewise.
	* merger.c: Likewise.
	* rcs.c: Likewise.
	* rcsbase.h: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcskeep.c: Likewise.
	* rcslex.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.
	* rlog.c: Likewise.

2010-02-25  Thien-Thi Nguyen  <ttn@gnuvola.org>

	Drop RCS keyword `Id' from code.

	* rcsbase.h (RCSBASE, libId): Delete #define:s.
	(mainProg): Don't take 3rd arg; don't define `baseid', lib id string.
	* ci.c: Update `mainProg' call.
	* co.c: Likewise.
	* ident.c: Likewise.
	* merge.c: Likewise.
	* rcs.c: Likewise.
	* rcsclean.c: Likewise.
	* rcsdiff.c: Likewise.
	* rcsmerge.c: Likewise.
	* rlog.c: Likewise.
	* merger.c: Delete `libId' call.
	* rcsedit.c: Likewise.
	* rcsfcmp.c: Likewise.
	* rcsfnms.c: Likewise.
	* rcsgen.c: Likewise.
	* rcskeep.c: Likewise.
	* rcskeys.c: Likewise.
	* rcslex.c: Likewise.
	* rcsmap.c: Likewise.
	* rcsrev.c: Likewise.
	* rcssyn.c: Likewise.
	* rcstime.c: Likewise.
	* rcsutil.c: Likewise.
	* conf.sh (Id): Delete var.
	* maketime.c (maketId): Likewise.
	* partime.c (partimeId): Likewise.

2010-02-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[admin] Move install-sh, mkinstalldirs into new dir build-aux/.

	* Makefile.in (bauxdir): New var.
	(installdirs): Use $(bauxdir).

Fri Jun 16 06:19:24 1995  Paul Eggert  <eggert@twinsun.com>

	* version.c: Version 5.7 released.
	* Makefile.in (TESTPREFIX): Remove; replaced with $(srcdir)/.
	* rcsutil.c (catchsig): Remove `return'.
	* Makefile.in, ci.c, co.c, conf.sh, ident.c, maketime.c, maketime.h,
	merge.c, merger.c, partime.c, partime.h, rcs.c, rcsbase.h, rcsclean.c,
	rcsdiff.c, rcsedit.c, rcsfcmp.c, rcsfnms.c, rcsgen.c, rcskeep.c,
	rcskeys.c, rcslex.c, rcsmap.c, rcsmerge.c, rcsrev.c, rcssyn.c, rcstest,
	rcstime.c, rcsutil.c, rlog.c:  Update FSF address.

Mon Jun  5 08:30:02 1995  Paul Eggert  <eggert@twinsun.com>

	* version.c (RCS_version_string): Update to 5.6.8.1 (beta).

Fri Jun  2 18:19:00 1995  Paul Eggert  <eggert@twinsun.com>

	* rcsutil.c (catchsigaction):
	New name for `catchsig', for sa_sigaction signature.
	Use nRCS even if !has_psiginfo, to remove unused variable warning.
	(setup_catchsig): Use sa_sigaction only if has_sa_sigaction.
	Use ENOTSUP only if defined.
	* conf.sh, conf.heg (has_sa_sigaction): New configuration variable.

Thu Jun  1 16:23:43 1995  Paul Eggert  <eggert@twinsun.com>

	* version.c (RCS_version_string): Update to 5.6.8 (beta).

	* Makefile.in:
	Renamed from Makefile; autoconf now preprocesses this file.
	Rewrite to follow GNU makefile standards.
	(clean): `rm core*' -> `rm core core.* *.core', for BSD/OS 2.0.

	* ci.c (main): Add -kb.  Use `cmpdate', not `cmpnum', to compare dates.
	Don't worry about errno after ftruncate fails.
	Fix input file rewinding bug when large_memory && !maps_memory
	and checking in a branch tip.

	(fixwork): Fall back on chmod if fchmod fails; it might be ENOSYS.

	* co.c (main, preparejoin):
	Pass argument instead of using `join' static variable.
	(main): Add -kb.

	* ident.c (exiterr, reportError):
	New functions, needed for DOS and OS/2 ports.
	(scanfile): Use them.

	* rcsdiff.c (main):
	Pass "--binary" if -kb and if --binary makes a difference.
	Don't treat + options specially.

	* rcsmerge.c (main):
	Report an error if -kb, so don't worry about binary stdout.
	Punctuate messages properly.  Rewrite to avoid `goto end'.

	* rcs.c (main):
	Warn if no options were given.  Punctuate messages properly.

	(sendmail): Rewind mailmess before flushing it.
	Output another warning if mail should work but fails.

	(buildeltatext): Pass "--binary" if -kb and if --binary is needed.

	* merger.c (normalize_arg): Don't treat + options specially.
	(merge): Don't make -A the default; always use -E.
	Always open working file in text mode.

	* rlog.c (struct rcslockers): Renamed from `struct lockers'.
	(getnumericrev): Return error indication instead of ignoring errors.
	(main): Check it.  Don't use dateform.
	(recentdate, extdate): cmpnum -> cmpdate

	* rcsclean.c (unlock): struct lock -> struct rcslock

	* rcsedit.c (dirtpname): No longer external.
	(do_link): Simplify logic.
	(finisheditline, finishedit): Replace Iseek/Itell with definiens.
	(fopen_update_truncate): Replace `#if' with `if'.
	(keyreplace, makedirtemp): dirlen(x) -> basefilename(x)-x.

	(edit_string): Fix bug: if !large_memory, a bogus trailing `@' was
	output at the end of incomplete lines.

	(keyreplace): Do not assume that seeking backwards
	at the start of a file will fail; on some systems it succeeds.
	Convert C- and Pascal-style comment starts to ` *' in comment leader.

	(rcswriteopen): Use fdSafer to get safer file descriptor.
	Open RCS file with FOPEN_RB.

	(chnamemod): Work around bad_NFS_rename; don't ignore un_link result.
	Fall back on chmod if fchmod fails, since it might be ENOSYS.

	(aflush): Move to rcslex.c.

	* rcsfcmp.c (rcsfcmp): Add -kb support.

	* rcsfnms.c (basefilename): Renamed from basename to avoid collisions.
	(dirlen): Remove (for similar reasons).
	(rcsreadopen): Open with FOPEN_RB.
	(SLASHSLASH_is_SLASH): Default is 0.
	(getcwd): Work around bad_wait_if_SIGCHLD_ignored bug.

	* rcsgen.c (putadmin): Open RCS file with FOPEN_WB.

	* rcskeep.c (getoldkeys): Don't panic if a Name: is empty.

	* rcslex.c:
	(map_fd_deallocate, mmap_deallocate, read_deallocate,
	nothing_to_deallocate): New functions.
	(Iclose): If large_memory and maps_memory, use them to deallocate.
	(fd2RILE): Use map_fd if available.
	If one mapping method fails, try the next instead of giving up;
	if they all fail, fall back on ordinary read.
	Work around bug: root mmap over NFS succeeds, but accessing dumps core.
	Use MAP_FAILED macro for mmap failure, and `char *' instead of caddr_t.
	(advise_access): Use madvise only if this instance used mmap.
	(Iopen): Use fdSafer to get safer file descriptor.
	(aflush): Moved here from rcsedit.c.

	* rcsrev.c (cmpdate, normalizeyear):
	New functions work around MKS incompatibility.
	(cmpnum, compartial): s[d] -> *(s+d) to work around Cray compiler bug.
	(genrevs, genbranch): cmpnum -> cmpdate

	* rcssyn.c (expand_names): Add "b" for -kb.
	(getdelta): Don't strip leading "19" from MKS dates; see cmpdate.

	* rcsutil.c (catchsig, restoreints, setup_catchsig):
	Use SA_SIGINFO, not has_psiginfo,
	to determine whether to use SA_SIGINFO feature,
	but also check at runtime whether the feature works.
	(catchsig): If an mmap_signal occurs, report the affected file name.
	(unsupported_SA_SIGINFO, accessName): New variables.
	(setup_catchsig): If using SA_SIGINFO, use sa_sigaction not sa_handler.
	If SA_SIGINFO fails, fall back on sa_handler method.

	(readAccessFilenameBuffer, dupSafer, fdSafer, fopenSafer): New fns.
	(concatenate): Remove.

	(runv): Work around bad_wait_if_SIGCHLD_ignored bug.
	Remove reference to OPEN_O_WORK.

	* maketime.h (adjzone, str2time):
	Time zones are now (long) seconds, not (int) minutes.
	(const): Remove.

	* maketime.c (difftm):
	Use smaller expressions, to avoid confusing buggy compilers.
	(adjzone, str2time): Time zones are (long) seconds, not (int) minutes.

	* partime.c (zone_names):
	Add "jdt", since Japan might use it.  "nrt" -> "nrft".
	Use special markers 1 and -1, not TM_LOCAL_ZONE and TM_UNDEFINED_ZONE,
	to avoid integer overflow now that time zones are seconds, not minutes.
	(parse_decimal): Round to even.
	(parzone): Time zones are now (long) seconds, not (int) minutes,
	as allowed by ISO 8601.

	* partime.h (TM_UNDEFINED_ZONE, zone):
	Now (long) seconds, not (int) minutes.
	(const): Remove.

	* rcstime.c (dateform): Remove.
	(zone_offset, str2time_checked, zone_set, date2str):
	Time zones are now (long) seconds, not (int) minutes.
	(date2str): Use `-08' style time zone, not `-0800', for ISO 8601.

	* conf.sh: `#!/bin/sh' -> `#! /bin/sh'; some picky hosts require this.
	Ensure we don't run as root; it would yield the wrong answers.
	Ensure the C compiler works on a trivial program first.
	Rename incoming environment variables to follow GNU makefile standards.
	Use $PREPARE_CC consistently.

	(_POSIX_C_SOURCE, <mach/mach.h>, <net/errno.h>, has_map_fd,
	bad_NFS_rename, has_si_errno, bad_wait_if_SIGCHLD_ignored):
	New configuration options.

	(has_sys_dir_h, text_equals_binary_stdio, text_work_stdio,
	FOPEN_R, FOPEN_W, FOPEN_WPLUS, has_caddr_t, DIFF3_A): Remove.

	(O_BINARY, OPEN_O_WRONLY, FOPEN_RB, FOPEN_R_WORK, FOPEN_WB,
	FOPEN_W_WORK, FOPEN_WPLUS_WORK): New macros, for -kb support.
	(bad_fopen_wplus): Use "w+", not FOPEN_WPLUS.

	(has_const, has_volatile): Rename test functions to avoid collisions.
	(has_fchmod, has_mmap, has_vfork): fileno(stdio) -> STDIN_FILENO.
	(has_fflush_input): Don't trust fflush's return value when testing.
	(has_mmap): Use MAP_FAILED if available.  Look at 0th byte, not last.
	Define to 0 if HP-UX 8.07 or 9.*, or SunOS 5.4 before patch 10.
	(has_psiginfo): Handler's 3rd arg is void *, as per Posix 1003.1b-1993.
	(has_varargs): Don't set if has_stdarg.
	(large_memory): Also define to 1 if has_map_fd.
	(mmap_signal): Don't try to deduce it if creat yields ETXTBSY.

	* conf.heg: Adjust to latest conf.sh.

	* rcsbase.h (SIZEABLE_PATH):
	Don't depend on PATH_MAX: it's not worth configuring.
	(Ioffset_type, BINARY_EXPAND, MIN_UNEXPAND, MIN_UNCHANGED_EXPAND):
	New macros.
	(maps_memory): New macro; replaces many instances of `has_mmap'.
	(cacheptr): Renamed from cachetell.
	(struct RILE): New alternate name for RILE; the type is now recursive.
	(deallocate): New member for RILE, used for generic deallocation.
	(cacheunget_): No longer take a failure arg; just call Ierror.
	(struct rcslock): Renamed from struct lock, to avoid collisions with
	system headers on some hosts.  All users changed.
	(basefilename): Renamed from basename, likewise.
	(dirtpname): Remove; no longer external.
	(dirlen, dateform): Remove; no longer used.
	(cmpdate, fopenSafer, fdSafer, readAccessFilenameBuffer): New fns.
	(zonelenmax): Increase to 9 for full ISO 8601 format.
	(catchmmapints): Depend on has_NFS.

	* rcstest: Add -kb test.
	`#!/bin/sh' -> `#! /bin/sh'; some picky hosts require this.
	(ALL_CFLAGS): Renamed from CFLAGS.
	(LIBS): Renamed from LDLIBS.
	(CL): Add explicit `-o a.out'.

Thu Apr 14 06:55:24 1994  Paul Eggert  <eggert@twinsun.com>

	* conf.sh:  Relax test for puts.  Improve test for mmap; don't
	rely on getpagesize, output better messages when it fails,
	don't assume you can mmap something larger than the file,
	output "SIGSEGV" if appropriate, add commentary.

Wed Apr 13 16:31:38 1994  Paul Eggert  <eggert@twinsun.com>

	* version.c: now 5.6.7.4 (beta); intermediate versions were PC-related.
	* rcstime.c: Don't dump core if there's no zone.
	* rlog.c: Fix bug; `rlog -lxxx' inverted the sense of -l.

Sun Mar 20 04:52:58 1994  Paul Eggert  <eggert@twinsun.com>

	* version.c: now 5.6.7 (beta)

	* ci.c: Do not remove the lock when `ci -l' reverts.
	Do not generate a corrupted RCS file if the user modifies
	the working file while `ci' is running.
	* ci.c, co.c:
	Move buffer-flushes out of critical sections, as they aren't critical.
	* ci.c, co.c, merger.c, rcs.c, rcsbase.h, rcsdiff.c, rcsmerge.c,
	rcsutil.c: Specify subprocess input via file descriptor, not file name.
	* ci.c, co.c, rcs.c, rcsclean.c, rcsedit.c:
	Use ORCSerror to clean up after a fatal error.

	* ident.c: Remove `exiting' from identExit.

	* rcs.c, rcsgen.c: Flush stderr after prompt.

	* rcsclean.c: Add void_closedir support.

	* rlog.c: Emulate -V4's white space generation more precisely.
	-d'<DATE' now excludes DATE; the new syntax -d'<=DATE' includes it.
	* rlog.c, rcsgen.c: Work around SVR4 stdio performance bug.

	* rcsbase.h: Add primitives for reading backwards from a RILE;
	this is needed to go back and find the $Log prefix.

	* partime.c: Don't include rcsbase.h; you only need conf.h.
	Fix `am/pm' parsing bug.  Update time zones.

	* rcsedit.c, rcsfcmp.c:
	Normally calculate the $Log prefix from context, not from RCS file.

	* rcsfcmp.c:
	Calculate line numbers correctly even if the $Log prefix contains \n.

	* rcsfnms.c: Strip trailing SLASHes from TMPDIR; some systems need it.

	* rcslex.c: Don't worry if madvise fails.  Add Orewind.

	* rcsutil.c: Move setmtime to rcsedit.c.
	Avoid messing with I/O buffers in the child process.
	Define dup in terms of F_DUPFD if it exists.

	* Makefile: Make sure $(DESTBINDIR) exists before installing.
	Remove core* (for BSDI), RCS/a.*.

	* conf.sh: Do errno checking before readlink checking.
	Check for GCC __attribute__ infelicities.
	Output a better error message for wait problems.
	Check for AIX 3.2.0 mmap bug.  Update HP-UX test.
	Fix SLASHes typo.  Add SEEK_CUR.  Configure off_t, has_fflush_input.
	Improve test for __attribute__((noreturn)).
	* conf.heg: Adjust to latest conf.sh.

	* rcstest: Port to BSD/386 1.1's /bin/sh brain damage.
	Test for new $Log behavior.

	* co.c, merge.c, merger.c, rcs.c, rcsbase.h, rcsdiff.c, rcsedit.c,
	rcsfcmp.c, rcsfnms.c, rcsgen.c, rcskeep.c, rcslex.c, rcsmerge.c,
	rcsrev.c, rcssyn.c, rcsutil.c, rlog.c: Remove lint.

Tue Nov  9 17:55:29 1993  Paul Eggert  <eggert@twinsun.com>

	* version.c: now 5.6.6 (beta)
	* merge.c, rcsclean.c, rcsutil.c, rlog.c:
	-V now prints version on stdout and exits.
	* ci.c, co.c, rcs.c, rcsdiff.c, rcsmerge.c:
	Likewise.  Don't print usage twice.
	* Makefile: Add -Dhas_conf_h, maketime.h, partime.h, rcstime.c.
	ident wants version.o.
	* conf.heg, conf.sh: gcc doesn't do constant expressions in
	__attribute__((format(...))).
	* conf.sh: Quote $dots.
	* ident.c: Add -V.
	* maketime.c: Move RCS-specific stuff into rcstime.c.
	* maketime.h, partime.h, rcstime.c: New files.
	* partime.c: Complete rewrite from scratch.
	* rcsbase.h: Move RCS-specific time handling into rcstime.c.
	printf_string now takes two arguments, alas.
	* rcskeep.c: Use simpler time zone parsing strategy
	now that we're using ISO 8601 format.
	* rcslex.c: Fix `label: }' typo.
	* rcsrev.c: Fix format string typos.

Wed Nov  3 18:25:07 1993  Paul Eggert  <eggert@twinsun.com>

	* version.c: Initial revision; now 5.6.5 (beta)

	* ci.c, co.c, rcs.c, rcsdiff.c, rcsclean.c, rcsedit.c, rcsmerge.c,
	rcsrev.c, rlog.c: Add -z.

	* ci.c: Don't subtract from RCS file timestamp even if -T.
	Scan for and use Name keyword if -k.
	* ci.c, rcs.c, rcsbase.h, rcsgen.c, rcslex.c, rcssyn.c:
	Don't discard ignored phrases.
	* ci.c, co.c, rcs.c, rcsbase.h, rcsclean.c, rcsdiff.c, rcsfnms.c,
	rcsgen.c, rcskeep.c, rcslex.c, rcsrev.c, rcssyn.c:
	Improve quality of diagnostics.

	* co.c: Generate a value for the Name keyword.
	* co.c, rcsbase.h: Don't arbitrarily limit the number of joins.

	* ident.c: Test for char == EOF, not char < 0.

	* rcs.c: Don't lose track of -m or -t when there are no other changes.

	* rcsdiff.c: Put revision numbers in -c output.
	* rcsdiff.c, rcsbase.h, rcsedit.c, rcskeys.c: Add Name keyword.
	* rcsdiff.c, rcsmerge.c: Pass -Vn to `co'.
	* rcsdiff.c, rcsmerge.c, rlog.c: Ignore -T.

	* rcsmerge.c:
	Pass unexpanded revision name to `co', so that $Name works.
	* rcsmerge.c, rcsbase.h, merge.c, merger.c:
	Add -A, -E, -e.  Allow up to three labels.

	* rlog.c: Add -N.

	* rcsbase.h: Remove `nil'.  Improve quality of prototypes.

	* partime.c: Simplify time zone table.

	* rcsedit.c: If bad_unlink, ignore errno when unlink fails.
	Escape white space, $, and \ in keyword string file names.
	Don't output 2 spaces between date and time after Log.

	* rcskeep.c: Scan for Name keyword.

	* rcsfnms.c: Determine whether a file name is too long indirectly,
	by examining inode numbers, instead of trying to use operating system
	primitives like pathconf, which are not trustworthy in general.
	File names may now hold white space or $.
	Do not flatten ../X in pathnames; that may be wrong for symlinks.
	Add getabsname hook.

	* rcsfcmp.c:
	Fix yet another off-by-one error when comparing Log string expansions.

	* rcsrev.c: Add `namedrev' for Name support.
	Revision `.N' now stands for `D.N', where D is the default branch.

	* rcssyn.c: Parse MKS dates; ignore \r in diff control lines.

	* rcsutil.c: Use psiginfo and setreuid if available.
	Move date2str to maketime.c.

	* Makefile: Fix DIFF3_A default.

	* conf.sh: Update for RCS 5.6.5 (much better configuration messages).
	* conf.heg: Adjust to latest conf.sh.

	* rcstest: Compile our own program instead of using `tr'.
	Use rlog to get UTC instead of relying on `date -u'.
	Test `Name' keyword.

	* rcsfreeze.sh: Don't ignore RCS/.*,v files.

Tue Jun 29 17:03:43 1993  Paul Eggert  <eggert@twinsun.com>

	* maketime.c: Add -z support.  New function zone_set, date2str.
	str2time now has default_zone arg.  Parenthesize to keep GCC happy.

Tue Jul 28 16:12:44 1992  Paul Eggert  <eggert@twinsun.com>

	Version 5.6.4 (beta)

	* ci.c: Add -i, -j.  Check that working and RCS files are distinct.
	* ci.c, co.c, rcs.c, rcsclean.c, rcsdiff.c, rcsmerge.c, rcsutil.c,
	rlog.c: Add -V.

	* co.c, rcsclean.c: Check that working and RCS files are distinct.

	* rcs.c: rcs -l now asks whether you want to break the lock.
	Set RCS file's mode and time at right moment.

	* rcsclean.c: Fix -n bugs.

	* rcsdiff.c: Use co -M for better dates with traditional diff -c.

	* rlog.c: Don't miss B.0 when handling branch B.
	Diagnose missing `,' in -r.
	* rlog.c, rcsedit.c, rcslex.c, rcsrev.c, rcssyn.c:
	Avoid `unsigned'; this avoids the ULONG_MAX/10 configuration problem.
	* rlog.c, rcsbase.h, rcsedit.c, rcsgen.c rcsfcmp.c, rcskeep.c, rcslex.c,
	rcssyn.c: Statement macro names now end in _.

	* partime.c: Fix time zones again.

	* rcsedit.c: Some hosts have readlink but not ELOOP.
	Preserve dates more systematically.

	* rcsgen.c, rcsfnms.c: Be consistent about pathnames vs filenames.

	* rcsfnms.c: Add .sty.  .pl now implies Perl, not Prolog.
	Fix fdlock initialization bug.  Check that $PWD is really ".".

	* rcslex.c, rcsrev.c:  Identifiers may now start with a digit and
	(unless they are symbolic names) may contain `.'.

	* rcsutil.c: has_sigaction overrides sig_zaps_handler.  Fix -M bug.
	Add mmap_signal, which minimizes signal handling for non-mmap hosts.

	* Makefile: Add BINDIR.  Update for GCC 2.  Redo configuration scheme.
	Add rcsvers.c.

	* conf.sh: Output more chatter to keep builders happy.
	Fix several portability bugs: fileno, readlink, readlink errno,
	HP-UX brain damage, execv, mmap, waitpid, same_file.  Remove ULONG_MAX.
	* conf.heg: Adjust to latest conf.sh.

	* rcstest: Test rcsclean.  rm -f a.c more often.
	*'! 1.1.1.1') -> *!\ 1.1.1.1) to avoid some shell bugs.
	Set PWD unconditionally.  Don't assume RCS knows date's time zone.
	Avoid `tr' if possible; it's not standardized well.

Sun May 31 08:29:18 1992  Paul Eggert  <eggert@twinsun.com>

	* maketime.c:
	Complete rewrite from scratch, because we need to work even if
	the underlying implementation has leap seconds.

	* partime.c: The special time zone LOCAL_TIME+1 now tells maketime
	that no zone was given.

Mon Feb 17 23:02:28 1992  Paul Eggert  <eggert@twinsun.com>

	Version 5.6.3 (beta)

	* ci.c, co.c, rcs.c, rcsbase.h, rcsclean.c, rcsedit.c, rcsutil.c:
	Add -T.
	* ci.c: `-rREV' now just specifies a revision REV;
	only bare `-r' reverts to default.

	* rcsdiff.c: Output more readable context diff headers.
	Suppress needless checkout and comparison of identical revisions.

	* maketime.c:
	When setting a file's modification time, set its access time to now.

	* rcsbase.h, rcslex.c, rcsutil.c: Work around NFS mmap SIGBUS problem.

	* rcsfnms.c: `a/RCS/b/c' is now an RCS file with an empty extension,
	not just `a/b/RCS/c'.

	* conf.sh: Add has_utimbuf to avoid echo line length limit.
	Some sigactions don't allow 2nd arg of type struct sigaction const *.
	* conf.heg: Adjust to latest conf.sh.

	* rcsfreeze.sh: Use `rcs -nN:' to simplify the code.

Mon Jan 27 16:42:53 1992  Paul Eggert  <eggert@twinsun.com>

	Version 5.6.2 (beta)

	* ci.c: Always unlock branchpoint if caller has a lock.
	* ci.c, conf.sh, rcsedit.c: Support bad_chmod_close.
	* ci.c, co.c, conf.sh, rcs.c, rcsbase.h, rcsclean.c, rcsedit.c,
	rcsfnms.c, rcsgen.c: Support bad_creat0.
	* ci.c, co.c, ident.c, merge.c, rcs.c, rcsbase.h, rcsclean.c,
	rcsdiff.c, rcsmerge.c, rlog.c, rcsutil.c: lint -> RCS_lint

	* rcs.c: Add -M.
	Avoid invoking umask(); it's one less thing to configure.

	* rcsdiff.c: Add GNU diff 1.15.2's new options.

	* rlog.c: Don't duplicate unexpected_EOF's function.

	* maketime.c: Fix day of week bug with dates after February 28, 2100.

	* rcsfnms.c: Fix bug: Expand and Ignored weren't reinitialized.
	Avoid `char const c=ch;' compiler bug.

	* rcsgen.c: Move put routines here from rcssyn.c.
	* rcssyn.c: Move put routines to rcsgen.c.

	* rcsutil.c: Work around NFS mmap bug that leads to SIGBUS core dumps.

	* Makefile: Add DESTRCSDIR.  lint -> RCS_lint

	* conf.sh: Add workaround for `volatile sig_atomic_t' screwups,
	and for Ultrix 4.2 prototype brain damage.
	* conf.heg: Adjust to latest conf.sh.

Thu Jan  9 19:02:09 1992  Paul Eggert  <eggert@twinsun.com>

	* Makefile: $(LDLIBS) -o $@ -> -o $@ $(LDLIBS) to keep MS-DOS happy.

Mon Jan  6 03:04:24 1992  Paul Eggert  <eggert@twinsun.com>

	Version 5.6.1 (beta)

	* ci.c: Invoke utime() before chmod() to keep some buggy systems happy.

	* co.c, merge.c, rcsdiff.c, rcsmerge.c, rlog.c: Update usage string.

	* rcs.c:
	Avoid changing RCS file in common cases where no change can occur.

	* rcsbase.h, rcsedit.c, rcsfnms.c, rcsrev.c, rcssyn.c, rcsutil.c,
	rlog.c: while (E) ; -> while (E) continue;

	* rcsedit.c: Add setmode parameter to chnamemod.
	addsymbol now reports changes.

	* rcsfnms.c: Shorten long (>31 chars) name.

	* rcslex.c: Use OPEN_O_BINARY if mode contains 'b'.
	* rcsutil.c: O_BINARY -> OPEN_O_WORK

	* rcssyn.c: ULONG_MAX/10 -> ULONG_MAX_OVER_10

	* Makefile: Remove obsolete AIX comment.  sh -> $(SHELL).

	* conf.sh: Simplify MS-DOS port; work around several porting anomalies.
	* conf.heg: Adjust to latest conf.sh.

	* rcstest: mkdir RCS if it doesn't already exist.

Wed Nov 20 18:21:10 1991  Paul Eggert  <eggert@twinsun.com>

	Version 5.6 released.
	* ci.c, rcs.c: Don't read the delta tree from a nonexistent RCS file.
	* rcsmerge.c: Don't Iopen(f, "r+"); it's not portable.
	* conf.sh, conf.heg: Remove FOPEN_RPLUS.
	* rcstest: Test for rcs -i -A bug.

Sun Nov  3 03:30:44 1991  Paul Eggert  <eggert@twinsun.com>

	* rcsclean.c:
	Don't remove working files that look like they are checked out.

	* rcsedit.c: Move the warning about link breaking
	to where they're actually being broken.

	* rcslex.c: Fix porting bug to ancient hosts lacking vfprintf.

	* conf.sh: Detect yet another const compiler bug.
	Don't declare args to mmap, strchr, strrchr, in case they disagree.

Mon Oct  7 17:32:46 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c, rcs.c, rcsdiff.c: Remove lint.
	* ci.c, rcsgen.c: Fix log bugs, e.g. ci -t/dev/null when has_mmap.
	* co.c: -k affects just working file, not RCS file.
	* rcsfcmp.c: Count log lines correctly.
	* conf.sh: Add declare_signal, large_memory, O_EXCL.  Remove creat.
	* conf.heg: Adjust to latest conf.sh.
	* rcsbase.h, rcsedit.c, rcslex.c, rcsutil.c:
	Support piece tables even if !has_mmap.
	* rcsedit.c: Fix rare NFS bugs.
	* Makefile: Fix Minix description.

Thu Sep 26 23:10:30 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Plug file descriptor leak.

Tue Sep 24 00:49:12 1991  Paul Eggert  <eggert@twinsun.com>

	* rcsfnms.c: Don't export bindex().
	* rcslex.c: Don't export Ierror(), errsay().
	* rcsbase.h: Remove unexported functions.
	* Makefile: Put MS-DOS support into a separate distribution.

Wed Sep 18 07:29:10 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Work around a common ftruncate() bug.

Tue Sep 17 19:07:40 1991  Paul Eggert  <eggert@twinsun.com>

	* rlog.c: Getscript() didn't uncache partial lines.
	* rcsedit.c: SGI readlink() yields ENXIO, not EINVAL, for nonlinks.

Tue Sep 10 22:36:26 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c, rcsgen.c: Fix test for redirected stdin.

	* ident.c: Open files with FOPEN_R, not FOPEN_R_WORK,
	because they might be executables, not working files.

	* conf.heg: Adjust to latest conf.sh.

	* Makefile: Prepend $(DIFFPREFIX). to PATH.
	Adjust `make clean' for DOS.

Wed Aug 21 00:29:52 1991  Paul Eggert  <eggert@twinsun.com>

	* rcstest: Fix test for non-text diffs; it missed some botched diffs.

Tue Aug 20 23:05:00 1991  Paul Eggert  <eggert@twinsun.com>

	* merger.c: Fix !DIFF3_BIN porting bug.
	* conf.sh: Fix porting bugs for #include, SENDMAIL, pwd,
	cc with wrong exit status.

Mon Aug 19 23:17:54 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c: When there are no changes,
	revert to previous revision instead of aborting.
	* ci.c, co.c, rcs.c: Add -M.
	* ci.c, rcs.c, rcsbase.h, rcsedit.c, rcsgen.c: Add piece tables.
	* ci.c, rcs.c, rcsdiff.c, rcsmerge.c, rcsrev.c: Add -r$.
	* ci.c, co.c, merge.c, rcs.c, rcsbase.h, rcsdiff.c, rcsedit.c,
	rcsfcmp.c, rcsfnms.c, rcsgen.c, rcskeep.c, rcslex.c, rcsmerge.c,
	rcsrev.c, rcssyn.c, rcsutil.c, rlog.c: Tune.

	* co.c: Warn before removing somebody else's file.
	Fix co -j bugs.

	* ident.c: Report read errors immediately.

	* merge.c: Remove lint.

	* rcs.c, rlog.c: Revision separator is `:', not `-'.

	* rcsclean.c: Rewrite from scratch.

	* rcsdiff.c: Add RCSINIT.

	* rlog.c: Check for missing and duplicate logs.
	Permit log messages that do not end in newline (including empty logs).

	* rcskeys.c: Say `T const' instead of `const T';
	it's less confusing for pointer types.
	(This change was made in other source files too.)

	* rcslex.c: Add eoflex(), mmap support.

	* rcsrev.c: Add `-rB.'.  Remove botches like `<now>' from messages.

	* conf.sh: Add ALL_ABSOLUTE, FOPEN_RPLUS, ftell, getlogin_is_secure,
	RCS_SHELL, sigmask, strchr, TZ_must_be_set.
	Add checks for dirent, ftruncate, link, madvise, memcmp, memcpy,
	memmove, mmap, spawn, wait, utimbuf.
	Improve checks for const/volatile, va_start.
	Remove atoi, has_utime, strncmp, strncpy.
	Make NEW_LINK_BEHAVIOR the default.
	sgi has seteuid.
	Don't try to guess the bad line number by parsing the error message.
	* conf.heg: Adjust to latest conf.sh.

	* maketime.c: Add setfiledate, str2time, TZ_must_be_set.

	* merger.c: Plug memory leak.

	* partime.c: Update time zones.

	* rcsbase.h, rcsedit.c: Add NFS bug workarounds.
	* rcsedit.c: Catch odd filenames.

	* rcsfnms.c: Fix messages when rcswriteopen fails.
	Look in $TMP and $TEMP if $TMPDIR isn't set.

	* rcsmap.c: Don't assume EOF == -1.

	* rcsutil.c: Add spawn() support.
	Explicate assumptions about getting invoker's name.
	Standardize user-visible dates.

	* Makefile: Improve hooks to make DOS makefile from Unix makefile.
	Switch to GNU diff as the default.  ${} -> $().

	* rcstest: Add test for reverting checkin.  Ease DOS ports.
	Add PATH warning.

Sat Jun 22 22:43:23 1991  Paul Eggert  <eggert@twinsun.com>

	* rcsclean.sh: Unlock the correct version.

Sun Apr 21 11:59:14 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c, co.c, rcsbase.h, rcs.c, rcsdiff.c, rcsedit.c,
	rcsfnms.c, rcsmerge.c, rlog.c: Add -x, RCSINIT.
	* ci.c, co.c, conf.sh, Makefile, rcsbase.h, rcs.c, rcsdiff.c,
	rcsedit.c, rcsfcmp.c, rcsfnms.c, rcsgen.c, rcslex.c, rcsmerge.c,
	rcssyn.c, rlog.c: Add MS-DOS support.
	* ci.c, co.c: Ensure that working file is newer than RCS file
	after co -[lu].

	* merge.c, merger.c: Initial revision
	* partime.c: Don't put , just before } in initializer.
	* rcsedit.c, rcsfcmp.c, rcsfnms.c, rcssyn.c: Fix errno bugs.
	* rcskeep.c, rcssyn.c: Disambiguate names on shortname hosts.
	* rcskeys.c, rcsmap.c: Don't put , just before } in initializer.
	* rcsrev.c: Add tiprev().
	* rcsutil.c: Plug setuid security hole.
	* conf.sh, conf.heg: Fix several reported bugs.
	* rcstest: Fix porting bugs.
	* rcsfreeze.sh: Port to broken shells.

Sun Mar 17 05:42:57 1991  Paul Eggert  <eggert@twinsun.com>

	* rcsclean.sh: Support RCS file names.  Add -n.

Thu Feb 28 19:18:53 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Don't let a setuid ci create a new RCS file;
	rcs -i -a must be run first.
	Fix ci -ko -l mode bug.  Open work file at most once.

	* rcsbase.h, conf.sh, conf.heg: Try setuid() if seteuid() doesn't work.

	* rcsfcmp.c: Open work file at most once.

	* rcssyn.c: Fix null termination bug in reporting keyword expansion.

	* rcsutil.c: Try setuid() if seteuid() doesn't work.
	Check the results more carefully.

	* Makefile: Remove setuid installation -- it's now up to the users.

Tue Feb 26 17:48:39 1991  Paul Eggert  <eggert@twinsun.com>

	* ci.c: getdate -> getcurdate (SVR4 name clash)

	* ident.c: Don't report empty keywords.  Check for I/O errors.

	* rcs.c: 0444 -> S_IRUSR|S_IRGRP|S_IROTH for portability
	* rcs.c, rlog.c, rcslex.c, rcsutil.c:
	strsave -> str_save (DG/UX name clash)

	* rcsmerge.c: Merging a revision to itself is no longer an error.

	* rlog.c: Survive RCS files with missing logs.

	* rcsbase.h: Move ANSI C / Posix declarations into conf.sh.
	* rcsbase.h, rcsedit.c, rcsfnms.c: Support new link behavior.

	* rcsedit.c: Work around broken "w+" fopen.
	* rcsedit.c, rcsfnms.c, rcsutil.c: Fix setuid bug.

	* rcsfnms.c: Support tempnam.  Define more portable getcwd().

	* rcslex.c: Work around fputs bug.

	* rcsrev.c: Avoid overflow when comparing revision numbers.

	* rcssyn.c: Check diff output more carefully; avoid overflow.

	* rcsutil.c: Use fread, fwrite more portably.
	Support waitpid.  Don't assume -1 is acceptable to W* macros.

	* Makefile: Remove setgid support.  Add NEW_LINK_BEHAVIOR.

	* conf.sh: Revamp extensively for portability.
	* conf.heg: Adjust to latest conf.sh.

	* rcstest: Work even if diff -c and diff3 -E don't.
	Improve handling of binary files and bad locks.

Mon Dec 31 01:00:12 1990  Paul Eggert  <eggert@twinsun.com>

	Version 5.5 released.
	* ci.c: Don't use uninitialized storage when handling -{N,n}.

Sun Dec 30 05:07:35 1990  Paul Eggert  <eggert@twinsun.com>

	* rcsedit.c:
	Fix report of busy RCS files when !defined(O_CREAT) | !defined(O_EXCL).

Thu Dec 27 19:54:26 1990  Paul Eggert  <eggert@twinsun.com>

	* rcsgen.c: Fix bug: rcs -t inserted \n, making RCS file grow.

Tue Dec 18 17:19:21 1990  Paul Eggert  <eggert@twinsun.com>

	* rcs.c: Fix bug with multiple -n and -N options.

Thu Dec 13 06:54:07 1990  Paul Eggert  <eggert@twinsun.com>

	* rcsdiff.c, Makefile: GNU diff 1.15 has -u.

Tue Dec  4 05:18:49 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c, co.c, rcs.c, rcsbase.h, rcsgen.c, rcslex.c, rcsutil.c:
	Use -I for prompts and -q for diagnostics.

	* co.c: Don't checkaccesslist() unless necessary.

	* rcsutil.c: Don't output a blank line after a signal diagnostic.

Tue Nov 27 09:26:05 1990  Paul Eggert  <eggert@twinsun.com>

	* rcsfcmp.c: Fix comment leader bug.

Sun Nov 11 00:06:35 1990  Paul Eggert  <eggert@twinsun.com>

	* rcs.c: Fix `rcs -e' core dump.

Mon Nov  5 20:30:10 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Don't remove working file when aborting due to no changes.

Thu Nov  1 05:28:48 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c, rcs.c: Add -I and new -t behavior.
	* ci.c, rcs.c, rcsbase.h, rcsedit.c, rcsgen.c, rcsfcmp.c, rcsfnms.c,
	rcssyn.c, rlog.c: Permit arbitrary data in logs and comment leaders.

	* co.c: Fix -j.  Add -I.

	* merge.sh: Yield exit status 2 on error like the man page says.

	* rcsdiff.c, rcsmerge.c, rcsutil.c: Remove unneeded setid check.

	* maketime.c: Remove lint.

	* rcsbase.h: Don't assume that builtins are functions;
	they may be macros.

	* rcsgen.c: Add -I and new -t behavior.

	* rcslex.c, rcssyn.c:
	When ignoring unknown phrases, copy them to the output RCS file.

	* rcssyn.c: Don't check for nontext on initial checkin.

	* rcsutil.c: Add awrite(), fremember().

	* Makefile: Add test and debug instructions.
	Remove unwieldy "make depend" stuff.

	* conf.sh: Use better guess for Posix 1003.1-1990 seteuid() behavior.
	(A real test would requiring running conf.sh setid.  Ugh!)
	Use test for vfork() that detects GCC 1.37.1+sparc and IRIX bugs.
	Use better test for const and volatile.
	User better test for include files; just running cpp isn't enough,
	because the include files may be buggy.
	Don't assume that builtins are functions; they may be macros.
	Remove DIFF_ARBITRARY.
	* conf.heg: Initial revision

	* rcsclean.sh: Basically a complete rewrite.  Add rcsdiff options.
	Clean working directory if no arguments are given.

	* rcsfreeze.sh: Check for errors better.
	Remove the need for one of the temporary files.

Sat Oct  6 00:16:45 1990  Paul Eggert  <eggert@twinsun.com>

	* rcsutil.c: Don't fread F if feof(F).

Thu Oct  4 06:30:22 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c, co.c, rcs.c, rcsdiff.c, rlog.c:
	Accumulate exit status across files.

	* maketime.c: Don't assume time_t is 32 bits.
	Calculate the GMT offset of 'xxx LT' as of xxx, not as of now.
	Fix bugs near epoch and near end of time.

	* partime.c: Check for overflow when lexing an integer.
	Remove date vs time heuristics that fail between 2000 and 2400.
	Parse 'Jan 10 LT' as 'Jan 10, LT', not 'Jan, 10 LT'.

	* rcskeep.c: Parse time zone offsets;
	future RCS versions may output them.

Thu Sep 27 01:31:43 1990  Paul Eggert  <eggert@twinsun.com>

	* rcsdiff.c: Yield 1, not EXIT_FAILURE, when diffs are found.
	* rcsbase.h, conf.sh: Port wait() to non-Posix ANSI C hosts.
	* conf.sh: Test for vfork() file descriptor screwup.

Tue Sep 25 20:11:46 1990  Adam Hammer  <hammer@cs.purdue.edu>

	* ci.c: fixed another small typo

Mon Sep 24 18:56:31 1990  Paul Eggert  <eggert@twinsun.com>

	* partime.c: Update time zones.

Fri Sep 21 06:16:38 1990  Adam Hammer  <hammer@cs.purdue.edu>

	* ci.c: made it handle multiple -{N,n}'s.
	Also, made it treat re-directed stdin the same as the terminal

Thu Sep 20 07:58:32 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c: ci -k now checks dates more thoroughly.

	* merge.sh: Fix bug in passing arguments to old diff3 programs.
	Fix calculation of #!/bin/sh header.

	* rcskeep.c: ci -k now checks dates more thoroughly.

	* rcssyn.c:
	Remove the test for non-text bytes; it caused more pain than it cured.

	* conf.sh: Calculate signal_type more reliably on older systems.

	* rcstest: Adjust to old and brain damaged diffs.

Sat Sep 15 01:29:51 1990  Paul Eggert  <eggert@twinsun.com>

	* conf.sh: Output header warning that it's generated automatically.

Tue Sep 11 02:41:16 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Fix revision bug with `ci -k file1 file2'.
	* co.c: co -kv yields a readonly working file.
	* rcsdiff.c: Simplify -kkvl test.
	* rlog.c: Plug memory leak.
	* rcsedit.c: Tune expandline().
	* rcsfcmp.c: Don't ignore differences in keyword strings if -ko is set.
	* Makefile: Don't make -R the default.

Tue Sep  4 17:07:19 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Permit adjacent revisions with identical time stamps
	(possible on fast hosts).
	* ci.c, rcsbase.h, rcsedit.c: Improve incomplete line handling.
	* ci.c, co.c, rcs.c, rcsbase.h, rcsgen.c:
	Standardize yes-or-no procedure.

	* rcsdiff.c: Diff's argv was too small by 1.

	* rlog.c, rcsedit.c, rcslex.c, rcssyn.c: Count RCS lines better.

	* rcsmerge.c: Check for I/O error when reading working file.

	* partime.c: Don't permit 'Aug Aug'.
	Don't parse two-digit years, because it won't work after 1999/12/31.

	* rcsbase.h: Don't redefine NAME_MAX, PATH_MAX.

	* rcsfnms.c: Fix typo when !RCSSEP.

	* rcsgen.c: Fix `co -p1.1 -ko' bug.

	* rcssyn.c: Parse RCS files with no revisions.
	Don't strip leading white space from diff commands.

	* rcsutil.c: Store fread()'s result in an fread_type object.

	* conf.sh: Don't include <stdarg.h> unless has_prototypes is set.

	* rcstest: Test -kkv, etc.
	Work even when today's day of the month is less than 10.

Wed Aug 29 07:14:52 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Expand locker value like co.
	* ci.c, rcs.c, rcsbase.h, rcsfcmp.c, rcsgen.c, rcssyn.c:
	Clean old log messages too.

	* merge.sh: Add -q.

	* rcs.c: Remove unused setuid support.

	* rcsdiff.c, rcsbase.h rcsedit.c, rcssyn.c: Add -kkvl.

	* rcsmerge.c: Add -q.  Pass -L options to merge.

	* partime.c: Be able to parse our own date format.
	Don't assume year<10000.

	* rcsbase.h: Fix type typos exposed by porting.

	* rcsedit.c:
	Fix bug when getting revisions to files ending in incomplete lines.
	Fix bug in comment leader expansion.

	* rcsfnms.c, rcslex.c:
	Work around buggy compilers with defective argument promotion.

	* rcsutil.c: Declare getpwuid() more carefully.

	* Makefile: Remove -g from default CFLAGS.

	* conf.sh: Fix porting bugs.  Add sanity checks and better doc strings.

	* rcstest: Initial revision

Wed Aug 22 08:49:14 1990  Paul Eggert  <eggert@twinsun.com>

	* ci.c: Don't pass +args to diff.
	* ci.c, co.c, rcsbase.h, rcsdiff.c, rcsedit.c, rcskeys.c, rcssyn.c:
	Add -k.
	* ci.c, co.c, rcs.c, rcsbase.h, rcsdiff.c, rcsedit.c, rcsmerge.c,
	rcsutil.c, rlog.c: Add -V.
	* ci.c, co.c, ident.c, rcs.c, rcsbase.h, rcsdiff.c, rcsedit.c,
	rcsfnms.c, rcsgen.c, rcskeep.c, rcslex.c, rcsmerge.c, rcsrev.c,
	rcssyn.c, rcsutil.c, rlog.c:
	Remove compile-time limits; use malloc instead.
	* ci.c, co.c, rcs.c, rcsbase.h, rcsdiff.c, rcsutil.c, rlog.c:
	Add setuid support.
	* ci.c, rcsedit.c, rcskeep.c, rcssyn.c: Don't require a final newline.
	* ci.c, co.c, rcs.c, rcsdiff.c, rcsedit.c, rcsfnms.c, rcsmerge.c:
	Make lock and temp files faster and safer.
	* ci.c, co.c, maketime.c, rcs.c, rcsedit.c, rcsfnms.c, rcskeep.c,
	rcsutil.c: Permit dates past 1999/12/31.
	* ci.c, co.c, rlog.c, maketime.c, partime.c, rcsutil.c, Makefile:
	Switch to GMT and fixed the bugs exposed thereby.
	* ci.c, rcs.c, rcsedit.c, rcssyn.c: Check diff's output.
	* ci.c, co.c, rcsbase.h, rcsutil.c: Remove snooping.
	* ci.c, co.c, rcs.c, rcsfnms.c, rcskeep.c, rcsmerge.c, rcsrev.c,
	rcssyn.c, rcsutil.c: Tune.
	* ci.c, co.c, ident.c, maketime.c, partime.c, rcs.c, rcsbase.h,
	rcsdiff.c, rcsedit.c, rcsfcmp.c, rcsfnms.c, rcsgen.c, rcskeep.c,
	rcskeys.c, rcslex.c, rcsmerge.c, rcsrev.c, rcssyn.c, rcsutil.c, rlog.c:
	Ansify and Posixate.

	* co.c, rcsutil.c: Permit multiple locks by same user.

	* ident.c: Don't limit output to known keywords.
	* ident.c, rcs.c, rcsfcmp.c, rcsrev.c, rcssyn.c: Remove lint.

	* merge.sh: Become a shell file that outputs the needed shell file.
	Support GNU diff3.  Add -L.

	* rcs.c: Don't lose names when applying -a option to multiple files.
	Fix umask bug.  Yield proper exit status.

	* rcsdiff.c: Don't pass arguments with leading '+' to diff;
	GNU DIFF treats them as options.  Add GNU diff's flags.
	* rcsdiff.c, rcsbase.h, rcsmerge.c, rcsfnms.c: Don't use access().

	* rcsmerge.c: Propagate merge's exit status.

	* rlog.c:
	Report dates in long form, to warn about dates past 1999/12/31.
	Change "added/del" message to make room for the longer dates.
	* rlog.c, rcsedit.c: Don't generate trailing white space.

	* partime.c: Update time zones.  Fix peekahead and int-size bugs.

	* rcsbase.h: Adjust ANSI C / Posix support.  Remove v2 support.
	* rcsbase.h, rcslex.c, rcssyn.c: Add support for ISO 8859.

	* rcsedit.c, rcsfcmp.c: Don't append "checked in with -k by " log to
	logs, so that checking in a program with -k doesn't change it.

	* rcsfnms.c: Ignore signals when manipulating the semaphore file.
	Modernize list of file name extensions.
	Beware file names beginning with "-".
	Fix test for non-regular files.

	* rcskeep.c: Retrieve old log message if there is one.

	* rcslex.c: Report errno-related errors with perror().
	Use better hash function.

	* rcsrev.c: Remove possibility of an internal error.

	* rcssyn.c: Try to parse future RCS formats without barfing.
	Don't output branch keyword if there's no default branch,
	because RCS version 3 doesn't understand it.
	Check that a newly checked-in file is acceptable as input to 'diff'.

	* rcsutil.c: Some USG hosts define NSIG but not sys_siglist.
	Don't run /bin/sh if it's hopeless.
	Don't leave garbage behind if the output is an empty pipe.
	Clean up after SIGXCPU or SIGXFSZ.
	Print name of signal that caused cleanup.

	* Makefile: Configure more automatically.  Upgrade for RCS 5.0.

	* conf.sh, rcsmap.c: Initial revision

Wed May 23 06:54:32 1990  Paul Eggert  <eggert@twinsun.com>

	* Makefile: Make Posix the default; it's the wave of the future.
	Add advice for SunOS.  Remove references to rcsclean, rcsfreeze.

Thu Mar 22 07:06:14 1990  Paul Eggert  <eggert@twinsun.com>

	* merge.sh: Add support for GNU DIFF 1.15.

	* Makefile: Permit dates past 1999/12/31.  Ansify and Posixate.
	Remove snoop and v2 support.  Add <vfork.h> flag.

Sat Nov 18 13:34:16 1989  Adam Hammer  <hammer@cs.purdue.edu>

	Version 4.3 released.

Mon Oct 30 12:29:00 1989  Daniel Trinkle  <trinkle@cs.purdue.edu>

	* rcsclean.c:
	Added -q option to agree with man page, added code to actually unlock
	the RCS file if there were no differences, picked a bit of lint.

Wed Jun 28 12:56:23 1989  Paul Eggert  <eggert@twinsun.com>

	* rcsfnms.c:
	Prevent checkin of all non-regular files, not just directories.

Wed Jun 28 09:02:14 1989  Thomas Narten  <narten@cs.purdue.edu>

	Version 4.2 released.

Mon May  1 15:17:14 1989  Thomas Narten  <narten@cs.purdue.edu>

	changed copyright header to reflect current distribution rules

	* rcsbase.h: changed #include <strings.h> -> string.h for USG systems.
	* partime.c: fixed #ifdef DEBUG construct
	* rcsfnms.c: changed getwd to not stat empty directories.

Thu Dec  8 14:02:20 1988  Paul Eggert  <eggert@sm.unisys.com>

	* rcsfnms.c:
	Fix bug: "co -p .../RCS/dir,v" failed if ./dir is a directory.

Tue Nov  8 16:01:02 1988  Thomas Narten  <narten@cs.purdue.edu>

	* ci.c: changes from root@seismo.CSS.GOV (Super User)
	-d with no arguments uses the mod time of the file it is checking in

	* rcs.c: removed include <sysexits.h> (not needed)
	minor fix for -A option

	* rcsbase.h: removed defs for functions loaded from libraries
	* maketime.c: allow negative time zones (-24h <= x <= 24h)
	* rcsedit.c: misplaced semicolon caused infinite loop
	* rcsutil.c: corrected use of varargs routines

Sun Aug 28 15:09:38 1988  Paul Eggert  <eggert@sm.unisys.com>

	* Makefile: 'make depend' now discards /usr/include/*
	(#ifdefs may comment around them).
	Use sed rather than ex for portability.  Remove obsolete comments.
	Separate LINTFLAGS.  Use LDFLAGS consistently.
	Edit DIFF in merge.sh.  Use execv(), not system(); allow cc -R.
	Permit signal handlers to yield either 'void' or 'int'.

	* rcslex.c:
	Don't loop when writing error messages to a full filesystem.
	Flush stderr/stdout when mixing output.
	Yield exit status compatible with diff(1).
	Shrink stdio code size; allow cc -R; remove lint.

	* rcsgen.c: Shrink stdio code size; allow cc -R; remove lint;
	isatty() -> ttystdin()

	* partime.c: Remove unportable "#endif XXX"s.

	* maketime.c: Allow cc -R.  Remove unportable "#endif XXX"s.

Tue Aug  9 19:13:28 1988  Paul Eggert  <eggert@sm.unisys.com>

	* ci.c: Remove lint.
	isatty(fileno(stdin)) -> ttystdin()
	Make sure workfile is a regular file;
	use its mode if RCSfile doesn't have one.
	* ci.c, rcsdiff.c, rcsedit.c: Allow cc -R.

	* co.c: Fix "co -d" core dump; rawdate wasn't always initialized.
	fix putchar('\0') and diagnose() botches.
	* co.c, rcs.c, rcsbase.h, rcskeep.c, rcssyn.c, rlog.c: Remove lint.

	* merge.sh:
	Check and yield proper exit status; keep temporary files private;
	economize to avoid a temporary file; fix "1 overlaps";
	keep '.' out of PATH.

	* rcsdiff.c, rcsmerge.c: Yield exit status like diff(1)'s.

	* rcsmerge.c: Beware merging into a readonly file.
	Beware merging a revision to itself (no change).

	* rcs.c: Don't access freed storage.
	Yield proper exit status.

	* rlog.c: Check for memory exhaustion; don't access freed storage.
	Shrink stdio code size.
	* rlog.c, rcsutil.c: Check for memory exhaustion.

	* rcsbase.h: Permit -Dhshsize=nn.
	* rcsbase.h, rcsedit.c, rcsfcmp.c: Shrink stdio code size.

	* rcskeep.c: Speed up by making FILE *fp local, not global.

	* rcsutil.c:  Permit signal handlers to yield either 'void' or
	'int'; fix oldSIGINT botch.  Yield exit status like diff(1)'s.

Wed Jul 27 00:31:11 1988  Paul Eggert  <eggert@sm.unisys.com>

	* merge.sh: RCS version 4

Thu Jun 23 16:06:55 1988  Paul Eggert  <eggert@sm.unisys.com>

	* sig_t.sh: Initial revision

Fri Dec 18 17:06:41 1987  Thomas Narten  <narten@cs.purdue.edu>

	* ci.c, co.c, rcs.c, rcsfcmp.c, rcskeep.c, rcssyn.c, rlog.c:
	lint cleanups (from Guy Harris)

	* rcsdiff.c:  changes Jay Lepreau made in the 4.3 BSD version,
	to add support for "-i", "-w", and "-t" flags and to permit
	flags to be bundled together, merged in.

	* maketime.c: include rcsparam.h

	* rcsbase.h: made removed BSD ifdef, now uses V4_2BSD

	* rcsedit.c:
	Changes from the 43. version. Don't know the significance of the
	first change involving "rewind". Also, additional "lint" cleanup.
	(Guy Harris)

	* rcsfnms.c:
	additional file types added from 4.3 BSD version, and SPARC assembler
	comment character added. Also, more lint cleanups. (Guy Harris)

	* rcsgen.c:
	additional lint cleanups, and a bug fix from the 4.3BSD version that
	keeps "ci" from sticking a '\377' into the description if you run it
	with a zero-length file as the description. (Guy Harris)

	* rcslex.c: fixed to use "varargs" in "fprintf";
	this is required if it is to work on a SPARC machine such as a Sun-4

	* rcsrev.c: more lint cleanups.
	Also, the NOTREACHED comment is no longer necessary,
	since there's now a return value there with a value. (Guy Harris)

	* Makefile: RCS version 4.0's Makefile

	* rcsfreeze.sh: Initial revision

Mon Nov 23 16:06:50 1987  Paul Eggert  <eggert@sm.unisys.com>

	* Makefile: Permit signal handlers to yield either 'void' or 'int'.

Fri Oct 23 17:09:57 1987  Thomas Narten  <narten@cs.purdue.edu>

	* ident.c: added exit(0) so exit return code would be non random

Tue Sep 15 16:39:39 1987  Roy Morris  <...!felix!roy>

	* rcsedit.c: added an initialization of the variables editline and
	linecorr; this will be done each time a file is processed.
	(there was an obscure bug where if co was used to retrieve multiple
	files it would dump)

Sun Oct 18 10:40:22 1987  Thomas Narten  <narten@cs.purdue.edu>

	Updating version numbers.
	Changes relative to revision 1.1 are actually relative to 4.x.

Mon Aug 24 13:57:19 1987  Thomas Narten  <narten@cs.purdue.edu>

	Sources now pass through lint
	(if you ignore printf/sprintf/fprintf warnings).

Mon Aug 10 11:52:53 1987  Paul Eggert  <eggert@sm.unisys.com>

	* co.c: 'co -d' dumped core; this fixes it.

Thu Jul  9 09:20:52 1987  Daniel Trinkle  <trinkle@cs.purdue.edu>

	* ident.c: Added check to make sure there is at least one arg
	before comparing argv[1] with "-q".  This necessary on machines
	that don't allow dereferencing null pointers (i.e. Suns).

Mon Jun 22 13:52:35 1987  Paul Eggert  <eggert@sm.unisys.com>

	* Makefile:
	Allow cc -R; add rclm; add $(LDFLAGS) when linking anything

	* rcs.c, rlog.c: Don't access freed storage.

	* rcs.c: If you lack locks, "rcs -u" now breaks the newest lock
	regardless of owner.

Fri Mar 27 14:21:53 1987  jenkins  <jenkins@cs.purdue.edu>

	Port to suns

Mon Mar 23 12:01:04 1987  Paul Eggert  <eggert@sm.unisys.com>

	* ci.c, co.c, rcs.c, rcsdiff.c, rcsmerge.c, rcsutil.c:
	Use execv(), not system(); yield proper exit status.
	* co.c: fix putchar('\0') and diagnose() botches.
	* rcsutil.c: Fix bug: catchints() didn't work if ignoreints()
	had already been called.
	* rcsmerge.c: Beware merging into a readonly file.
	Beware merging a revision to itself (no change).
	* rcsbase.h: Shrink stdio code size; remove lint; vfork=fork on USG
	* merge.sh:
	Check and yield proper exit status; clean up if interrupted;
	keep temporary files private; fix "1 overlaps" message.
	* ci.c, rcsdiff.c: Allow cc -R.
	* co.c, rcs.c: Remove lint.

Tue Mar 17 17:27:32 1987  loverso  <loverso@cs.purdue.edu>

	* ci.c: Don't allow non-regular files (directories, etc)
	to be checked in.

Mon Mar  9 17:11:52 1987  Paul Eggert  <eggert@sm.unisys.com>

	* rcsedit.c: Shrink stdio code size; allow cc -R.
	Fix linecorr botch: dumped core on Suns sometimes on 'co -rold f1 f2'.

Fri Feb 13 11:28:51 1987  Paul Eggert  <eggert@sm.unisys.com>

	* rlog.c: Add -W flag.
	* rcslex.c: Don't loop when writing error messages to a full filesystem
	Flush stderr/stdout when mixing output.
	Yield exit status compatible with diff(1).
	* rcsgen.c, rcslex.c, rlog.c: Allow cc -R; remove lint.
	* rcsfcmp.c, rcsgen.c, rcslex.c, rlog.c: Shrink stdio code size.

Thu Feb 12 18:24:19 1987  Paul Eggert  <eggert@sm.unisys.com>

	* ident.c: Add -efghi flags.
	* maketime.c, rcsfnms.c, rcssyn.c, sccstorcs.c: Allow cc -R.
	* rcsfnms.c: Fix troff macro comment leader bug; add Prolog.
	* rcskeep.c: Speed up by making FILE *fp local, not global.
	* rcsrev.c, All files above: Remove lint.

Tue Jul 29 12:17:25 1986  Guy Harris  <guy@sun.com>

	* maketime.c: More "lint" cleanups.

Mon Jul 28 23:34:14 1986  Guy Harris  <guy@sun.com>

	* Makefile: Netnews fixes from guy@sun
	* sccstorcs.c, rlog.c, rcsutil.c, rcssyn.c, rcsrev.c, rcsmerge.c,
	rcslex.c, rcskeep.c, rcsgen.c, rcsfnms.c, rcsfcmp.c, rcsedit.c,
	rcsdiff.c, rcsbase.h, rcs.c, ident.c, co.c, ci.c: More "lint" cleanups.

Thu Jul  3 13:09:55 1986  jdl  <jdl@cs.purdue.edu>

	* rcsclean.sh: New file.

Wed Jun 18 15:02:32 1986  Jay Lepreau  <lepreau@cs.purdue.edu>

	* rcsdiff.c: I broke -c<number> in last rev.
	Also, mixing a bopt with an otheropt was broken.

Mon May 19 02:36:16 1986  Jay Lepreau  <lepreau@cs.purdue.edu>

	* rcsdiff.c: Pass on new diff options, and allow them to be clustered.

Thu May 15 02:25:37 1986  Jay Lepreau  <lepreau@cs.purdue.edu>

	* Makefile: 4.3BSD revision
	* rcsedit.c: Use "Locked" instead of state in $Head expansion if locked.
	* rcsfnms.c: add suffix .el for gnulisp
	* rcsgen.c: Fix immediate EOF from non-tty files:
	avoid 0377's in description.

Tue Dec 17 13:59:09 1985  albitz  <albitz@cs.purdue.edu>

	* rcs.c: Changed setstate to rcs_setstate
	because of conflict with random.o.

Wed Jun 26 07:34:28 1985  svb  <svb@cs.purdue.edu>

	* rcsfnms.c: Comment leader '% ' for '*.tex' files added.

Wed Oct 17 21:12:11 1984  Admin  <root@cs.purdue.edu>

	* sccstorcs.c:  Added check for having multiple deltas in a row
	for the same revision.  --ks

Tue Dec 20 16:04:20 1983  Walter F. Tichy  <wft@purdue>

	* rcsbase.h: Increased logsize, added macro SMALLOG.
	moved setting of STRICT_LOCKING to Makefile.
	changed DOLLAR to UNKN (conflict with KDELIM).

Thu Dec 15 12:28:54 1983  Walter F. Tichy  <wft@purdue>

	* ci.c, co.c: ci -u and ci -l now set mode of working file properly.
	* rcs.c: rcs -u now breaks most recent lock
	if it can't find a lock by the caller.

	* rcsfnms.c: Added check for KDELIM in filenames to pairfilenames().

Mon Dec  5 13:40:54 1983  Walter F. Tichy  <wft@purdue>

	* ci.c: Merged with 3.9.1.1: added calls to clearerr(stdin).
	* ci.c, co.c, rlog.c: made rewriteflag external.

	* rcs.c: Added conditional compilation for sending mail.
	Alternatives: V4_2BSD, V6, USG, and other.

Fri Dec  2 22:47:45 1983  Walter F. Tichy  <wft@purdue>

	* rcsfnms.c: Added csh, red, and sl filename suffixes.

Wed Oct 19 04:22:11 1983  Jay Lepreau  <lepreau@purdue>

	* rcsbase.h: Make teeny logsize big
	* rcsgen.c: Added clearerr(stdin) for re-reading description from stdin.

Thu May 12 13:10:30 1983  Walter F. Tichy  <wft@purdue>

	* rcsedit.c:
	Added new markers Id and RCSfile; added locker to Header and Id.
	Overhauled expandline completely()
	(problem with $01234567890123456789@).
	Moved trymatch() and marker table to rcskeys.c.
	Log no longer expands full path of RCS file.

Wed May 11 14:24:13 1983  Walter F. Tichy  <wft@purdue>

	* rlog.c: Added -b, updated getnumericrev() accordingly.
	Replaced getpwuid() with getcaller().
	Added options -L and -R; Fixed selection bug with -l on multiple files.
	Fixed error on dates of the form -d'>date' (rewrote getdatepair()).

	* rcsedit.c: Fixed truncation problem for $19chars followed by@@.
	Added retry to expandline to resume after failed match which ended in $.

	* rcsfnms.c: Added initialization of Dbranch to InitAdmin().
	Changed pairfilenames():
	1. added copying of path from workfile to RCS file, if RCS file omitted;
	2. added getting the file status of RCS and working files;
	3. added ignoring of directories.
	Added comtable[] which pairs filename suffixes with comment leaders;
	updated InitAdmin() accordingly.

Tue May 10 17:03:06 1983  Walter F. Tichy  <wft@purdue>

	* ci.c: Added option -d and -w, and updated assignment of date, etc.
	to new delta.
	Option -k generates std. log message;
	fixed undef. pointer in reading of log.
	Replaced getlock() with findlock(),
	getpwuid() with getcaller().
	Moved all revision number generation to new routine addelta().
	Removed calls to stat(); now done by pairfilenames().
	Directed all interactive messages to stderr.
	* ci.c, co.c: Added handling of default branches.
	Replaced getpwuid() with getcaller().
	Replaced unlink()--link() with rename()
	* ci.c, co.c, rcs.c:
	Removed calls to stat(); now done by pairfilenames().
	Changed most calls to catchints() with restoreints().

	* co.c: Added option -u and -f.
	Changed and renamed rmoldfile() to rmworkfile().

	* rcs.c:
	Simplified breaklock(); added calls to findlock() and getcaller().
	Added option -b (default branch). Updated -s and -w for -b.
	Removed check for exit status of delivermail().
	Directed all interactive output to stderr.

	* ident.c: Added option -q and input from reading stdin.
	Marker matching is now done with trymatch() (independent of keywords).

	* rcsfcmp.c: Marker matching now uses trymatch().
	Marker pattern is now checked precisely.

	* rcsgen.c: Changed putamin() to abort if trying to reread redirected
	stdin.  Fixed getdesc() to output a prompt on initial newline.

	* rcskeep.c: Added new markers Id and RCSfile; extraction added.
	Marker matching with trymatch().

	* rcsutil.c: Added getcaller() and findlock().
	Changed catchints() to check SIGINT for SIG_IGN before setting up
	the signal (needed for background jobs in older shells).
	Added restoreints().
	Removed printing of full RCS path from logcommand().

Wed May  4 09:12:41 1983  Walter F. Tichy  <wft@purdue>

	* rcsbase.h: Added markers Id and RCSfile.
	Added Dbranch for default branches.

	* rcskeys.c: Initial revision

Tue May  3 22:13:19 1983  Walter F. Tichy  <wft@purdue>

	* rcsdiff.c: Added default branch, option -q, exit status like diff.
	Added fterror() to replace faterror().

Tue Apr  5 14:47:36 1983  Walter F. Tichy  <wft@purdue>

	* rcsfnms.c: fixed Suffix in InitAdmin().

Mon Mar 28 11:14:57 1983  Walter F. Tichy  <wft@purdue>

	* rcsmerge.c, rcssyn.c: Added handling of default branch.

Fri Mar 25 18:12:51 1983  Walter F. Tichy  <wft@purdue>

	* rcslex.c, rcsrev.c: Only changed $Header to $Id.

Fri Feb 18 17:37:49 1983  Walter F. Tichy  <wft@purdue>

	* ident.c: removed printing of new line after last file.

Tue Feb 15 15:41:49 1983  Walter F. Tichy  <wft@purdue>

	* ci.c, co.c, rcs.c, rcsutil.c: Added call to fastcopy()
	to copy remainder of RCS file in blocks.

Tue Jan 18 18:04:25 1983  Walter F. Tichy  <wft@purdue>

	* rcs.c: Changed sendmail(): now uses delivermail,
	and asks whether to break the lock.

Mon Jan 17 18:01:04 1983  Walter F. Tichy  <wft@purdue>

	* rcsfnms.c: Added getwd() and rename(); these can be removed by
	defining V4_2BSD, since they are not needed in 4.2 bsd.
	Changed sys/param.h to sys/types.h.

Sat Jan 15 17:46:50 1983  Walter F. Tichy  <wft@purdue>

	* rcs.c: Removed putree(); replaced with puttree() in rcssyn.c.
	Combined putdellog() and scanlogtext(); deleted putdellog().
	Cleaned up diagnostics and error messages.  Fixed problem with
	mutilated files in case of deletions in 2 files in a single command.
	Changed marking of selector from 'D' to DELETE.

	* rcsdiff.c: Expanded mainprogram to handle multiple RCS files.

	* rcsbase.h: Replaced dbm.h with BYTESIZ, fixed definition of rindex().
	Added variants of NCPFN and NCPPN for bsd 4.2,
	selected by defining V4_2BSD.  Added macro DELNUMFORM
	to have uniform format for printing delta text nodes.
	Added macro DELETE to mark deleted deltas.

	* rcssyn.c: Changed readdelta() to initialize selector and log-pointer.
	Changed puttree to check for selector==DELETE;
	putdtext() uses DELNUMFORM.

Fri Jan 14 15:37:31 1983  Walter F. Tichy  <wft@purdue>

	* ci.c, co.c, rcs.c:
	Added ignoring of interrupts while new RCS file is renamed;
	Avoids deletion of RCS files by interrupts.

Thu Jan  6 09:33:45 1983  Walter F. Tichy  <wft@purdue>

	* rcsdiff.c: Fixed passing of -c (context) option to diff.

Fri Dec 24 15:29:00 1982  Walter F. Tichy  <wft@purdue>

	* rcsdiff.c, rcsmerge.c: Added call to catchsig().
	* rlog.c: shortened output format.
	* rcskeep.c: added missing #endif.
	* rcsutil.c: added catchints(), ignoreints() for catching and ignoring
	interrupts; fixed catchsig().

Fri Dec 10 16:22:37 1982  Walter F. Tichy  <wft@purdue>

	* ci.c, rcs.c, rcsdiff.c: Corrected checking of return code from diff.
	* rcs.c: Removed unused variables,
	introduced variant COMPAT2 for skipping Suffix on -A files.
	* rcsdiff.c, rcslex.c: Improved error messages.
	* rcsmerge.c: Replaced getdelta() with gettree().
	* rcsbase.h: Added two forms of DATEFORM, one using %02d,
	the other %.2d.
	* rcslex.c: Changed exit status on error to 1.

Wed Dec  8 21:34:49 1982  Walter F. Tichy  <wft@purdue>

	* ci.c: Fixed return from addbranch().
	* ci.c, co.c, rcsutil.c, rlog.c: Using DATEFORM to format dates.

	* co.c: removed actual from call to preparejoin;
	re-fixed printing of done at the end.

	* rcs.c: Replaced getdelta() with gettree(),
	changed breaklock to update field lockedby, added some diagnostics.

	* rlog.c: removed call to checkaccesslist().
	* rlog.c, rcsfnms.c: removed unused variable.

	* rcssyn.c: renamed Commentleader to Commleader.

Sat Dec  4 13:24:08 1982  Walter F. Tichy  <wft@purdue>

	* ci.c: Updated field lockedby in removelock(),
	moved getlogmsg() before calling diff.
	* ci.c, co.c, rcsutil.c: Replaced SNOOPDIR with SNOOPFILE.
	* ci.c, co.c, rcsdiff.c, rcsrev.c, rlog.c:
	Replaced getdelta() with gettree().
	* co.c: Fixed printing of "done".
	* rcsdiff.c: Changed diagnostics.
	* ident.c, rcsbase.h: Added LOCKER.
	* rlog.c: Removed updating of field lockedby.
	* rcsbase.h: Locker, and USG (redefinition of rindex).
	* rcsedit.c: Added expansion of keyword Locker.
	* rcsfcmp.c, rcskeep.c: Initial revision
	* rcsrev.c: Replaced getdelta() with gettree().
	* rcssyn.c: Added routine gettree(),
	which updates keeplock after reading the delta tree.
	* rcsutil.c: changed addlock() to update lockedby-field.

Fri Dec  3 17:08:04 1982  Walter F. Tichy  <wft@purdue>

	* rcs.c:
	Replaced getlogin() with getpwuid(), fclose() with ffclose(),
	/usr/ucb/Mail with macro MAIL. Removed handling of Suffix (-x).
	fixed -u for missing revno.
	* rcs.c, rlog.c: Disambiguated structure members.

	* rlog.c:  Replaced getlogin with getpwuid(), %02d with %.2d,
	fancydate with PRINTDATE.  Fixed printing of nil, removed
	printing of Suffix, added shortcut if no revisions are printed.

	* rcsbase.h:
	Added dbm.h, stdio.h, RCSBASE, RCSSEP, RCSSUF, WORKMODE, TMPFILE3,
	PRINTDATE, PRINTTIME, map, and ctab; removed Suffix.
	Redefined keyvallength using NCPPN.
	Changed putc() to abort on write error.

	* rcsedit.c:  Added line number correction in case editing does
	not start at the beginning of the file.  Changed keyword
	expansion to always print a space before closing KDELIM;
	Expansion for Header shortened.

	* rcsutil.c: Added check to addlock() ensuring only one lock per person.
	Addlock also returns a pointer to the lock created.
	Deleted fancydate().

Thu Dec  2 13:27:13 1982  Walter F. Tichy  <wft@purdue>

	* ci.c: Added option -k.

Sun Nov 28 19:45:37 1982  Walter F. Tichy  <wft@purdue>

	* ci.c: Added mustcheckin() to check for redundant checkins.
	Added xpandfile() to do keyword expansion for -u and -l;
	-m appends linefeed to log message if necessary.
	getlogmsg() suppresses prompt if stdin is not a terminal.
	Replaced keeplock with lockflag.
	* ci.c, co.c:
	Replaced fclose() with ffclose(),
	%02d with %.2d, getlogin() with getpwuid().

	* co.c: Replaced mode generation for working file with WORKMODE.
	Fixed nil printing. Fixed -j combined with -l and -p, and exit
	or non-existing revisions in preparejoin().

	* ident.c: removed Suffix;
	added ungetc to avoid skipping over trailing KDELIM.

	* merge.sh: 4.3BSD revision

	* rcsmerge.c: Initial revision

	* rcsfnms.c: Changed mktempfile() to store the generated filenames.
	Changed getfullRCSname() to store the file and pathname,
	and to delete leading "../" and "./".

	* rcsgen.c: Replaced ferror() followed by fclose() with ffclose().
	Putdesc() now suppresses the prompts if stdin is not a terminal.
	A pointer to the current log message is now inserted into the
	corresponding delta, rather than leaving it in a global variable.

	* rcslex.c: Renamed ctab to map and included EOFILE;
	ctab is now a macro in rcsbase.h.
	Added fflsbuf(), fputs(), and fprintf(), which abort the RCS operations
	properly in case there is an IO-error (e.g., file system full).

	* rcsrev.c: fixed compartial() and compnum() for nil-parameters;
	fixed nils in error messages. Testprogram output shortened.

	* rcssyn.c: Reading and printing of Suffix removed;
	version COMPAT2 skips the Suffix for files of release 2 format.
	Fixed problems with printing nil.

Sat Nov 27 12:24:37 1982  Walter F. Tichy  <wft@purdue>

	* rcsutil.c:  moved rmsema(), trysema(), trydiraccess(),
	getfullRCSname() to rcsfnms.c.  Introduced macro SNOOP so that snoop
	can be placed in directory other than TARGETDIR.
	Changed %02d to %.2d for compatibility reasons.

Sun Nov 14 14:49:30 1982  Walter F. Tichy  <wft@purdue>

	* rcsedit.c:
	removed Suffix from keyword expansion. Replaced fclose with ffclose.
	keyreplace() gets log message from delta, not from curlogmsg.
	fixed expression overflow in while(c=putc(GETC....
	checked nil printing.

Fri Nov 12 14:29:40 1982  Walter F. Tichy  <wft@purdue>

	* rcsfnms.c: changed pairfilenames() to handle file.sfx,v;
	also deleted checkpathnosfx(),
	checksuffix(), checkfullpath(). Semaphore name generation updated.
	mktempfile() now checks for nil path; freefilename initialized properly.
	Added Suffix .h to InitAdmin. Added testprogram PAIRTEST.
	Moved rmsema, trysema, trydiraccess, getfullRCSname
	rom rcsutil.c to here.

Mon Oct 18 20:57:23 1982  Walter F. Tichy  <wft@purdue>

	* ci.c:
	Fixed ci -l, added ci -u (both do an implicit co after the ci).
	Changed conflicting identifiers.
	* ci.c, co.c, rcs.c: Fixed call to getlogin(), added call to
	getfullRCSname().
	* ci.c, co.c, rcs.c: An RCS file inherits its mode during the first ci
	or rcs -i from the working file, otherwise it stays the same,
	except that write permission is removed.
	* ci.c, co.c, rcs.c, rcsedit.c, rcsgen.c: Added check for write error.

	* co.c: The working file inherits its mode from the RCS file, plus
	write permission for the owner.  The write permission is not given if
	locking is strict and co does not lock.  An existing working file
	without write permission is deleted automatically.  Otherwise, co asks
	(empty answer: abort co).

	* rcs.c: I replaced curdir() with getfullRCSname(),
	cleaned up handling -U/L, and changed conflicting, long identifiers.

	* rcsdiff.c: Initial revision

	* rlog.c: call to curdir replaced with getfullRCSname(),
	fixed call to getlogin(), cosmetic changes on output,
	changed conflicting long identifiers.

	* rcsbase.h: added macro STRICT_LOCKING, removed RCSUMASK.
	renamed JOINFILE[1,2] to JOINFIL[1,2].

	* rcsedit.c: Renamed expandstring() to xpandstring().

	* rcsfnms.c: InitAdmin() now initializes StrictLocks=STRICT_LOCKING
	(def. in rcsbase.h).  renamed checkpath() to checkfullpath().

	* rcsgen.c: improved the prompt on putdesc().

	* rcsrev.c: renamed compnum->cmpnum, compnumfld->cmpnumfld,
	numericrevno->numricrevno.

	* rcssyn.c: renamed putdeltatext to putdtext.

	* rcsutil.c: added function getfullRCSname().

Wed Oct 13 16:04:59 1982  Walter F. Tichy  <wft@purdue>

	* ci.c: added include file dbm.h for getting BYTESIZ.
	This is used to check the return code from diff portably.
	* ci.c, co.c, ident.c, rcs.c, rcsedit.c, rcsgen.c, rlog.c:
	fixed type of variables receiving from getc() (char -> int).

	* co.c: removed unused variables.

	* rcsedit.c: made keyword expansion loop in expandline()
	portable to machines without sign-extension.

	* rcsutil.c: Cleanup message is now suppressed in quiet mode.

Mon Oct 11 19:41:17 1982  Walter F. Tichy  <wft@purdue>

	* rcsbase.h: removed NBPW, NBPC, NCPW.
	added typdef int void to aid compiling

	* rcslex.c: removed unused label out:;
	* rcslex.c, rcssyn.c:
	made sure all calls to getc() return into an integer, not a char.

	* rcsrev.c: changed expandsym() to check for source==nil;
	returns zero length string in that case.

Thu May  6 11:38:00 1982  Walter F. Tichy  <wft@purdue>

	* maketime.c, partime.c: Initial revision
